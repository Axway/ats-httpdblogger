<!doctype html>
<html>
 <head> 
  <title>ATS : Using the HTTP DB Logger's API via Python</title> 
  <link rel="stylesheet" href="styles/site.css" type="text/css"> 
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> 
 </head> 
 <body class="theme-default aui-theme-default"> 
  <div id="page"> 
   <div id="main" class="aui-page-panel"> 
    <div id="main-header"> 
     <a><img class="axway_logo" src="images/AxwayLogo.png" alt="Axway Inc"></a> 
     <div id="breadcrumb-section"> 
      <ol id="breadcrumbs"> 
       <li class="first"> <span><a href="index.html">ATS</a></span> </li> 
       <li> <span><a href="ATS-HTTP-DB-Logger-Guide.html">ATS HTTP DB Logger Guide</a></span> </li> 
      </ol> 
     </div> 
     <h1 id="title-heading" class="pagetitle"> <span id="title-text"> ATS : Using the HTTP DB Logger's API via Python </span> </h1> 
    </div> 
    <div id="content" class="view"> 
     <div id="main-content" class="wiki-content group"> 
      <pre><span style="color: rgb(128,128,128);">#!/usr/bin/python3<br></span><span style="color: rgb(128,128,128);"><br></span><span style="color: rgb(204,120,50);">import </span>http.client<br><span style="color: rgb(204,120,50);">import </span>json<br><br><span style="color: rgb(128,128,128);"># HttpDbLogger application host (it will be some kind of Java applications server - Tomcat/Jetty/etc<br></span>WEBSERVER_URL = <span style="color: rgb(106,135,89);">"127.0.0.1:8080"<br></span><span style="color: rgb(128,128,128);"># ats-httpdblogger-4.0.2-SNAPSHOT is the name of the deployed .war file<br></span><span style="color: rgb(128,128,128);"># and /service/logger is the full path to the logger sevice<br></span>HTTP_DB_LOGGER_LOGGER_URL = <span style="color: rgb(106,135,89);">"/ats-httpdblogger-4.0.2-SNAPSHOT/service/logger"<br></span><span style="color: rgb(106,135,89);"><br></span><span style="color: rgb(128,128,128);"># Relative URLs for each logging operation<br></span>START_RUN_REL_URL = <span style="color: rgb(106,135,89);">"start_run"<br></span>START_SUITE_REL_URL = <span style="color: rgb(106,135,89);">"start_suite"<br></span>START_TESTCASE_REL_URL = <span style="color: rgb(106,135,89);">"start_testcase"<br></span>INSERT_MESSAGE_REL_URL = <span style="color: rgb(106,135,89);">"insertMessage"<br></span>INSERT_MESSAGES_REL_URL = <span style="color: rgb(106,135,89);">"insertMessages"<br></span>ADD_RUN_METAINFO_REL_URL = <span style="color: rgb(106,135,89);">"add_run_meta_info"<br></span>ADD_SCENARIO_METAINFO_REL_URL = <span style="color: rgb(106,135,89);">"add_scenario_meta_info"<br></span>UPDATE_RUN_REL_URL = <span style="color: rgb(106,135,89);">"update_run"<br></span>UPDATE_SUITE_REL_URL = <span style="color: rgb(106,135,89);">"update_suite"<br></span>END_TESTCASE_REL_URL = <span style="color: rgb(106,135,89);">"end_testcase"<br></span>END_SUITE_REL_URL = <span style="color: rgb(106,135,89);">"end_suite"<br></span>END_RUN_REL_URL = <span style="color: rgb(106,135,89);">"end_run"<br></span>ATTACH_FILE = <span style="color: rgb(106,135,89);">"attachFile"<br></span><span style="color: rgb(106,135,89);"><br></span><span style="color: rgb(128,128,128);"># JSON keys, used in the creation of the requests' bodies<br></span>START_RUN_KEYS = [<span style="color: rgb(106,135,89);">"dbHost"</span><span style="color: rgb(204,120,50);">, </span><span style="color: rgb(106,135,89);">"dbName"</span><span style="color: rgb(204,120,50);">, </span><span style="color: rgb(106,135,89);">"dbUser"</span><span style="color: rgb(204,120,50);">, </span><span style="color: rgb(106,135,89);">"dbPassword"</span><span style="color: rgb(204,120,50);">, </span><span style="color: rgb(106,135,89);">"runName"</span><span style="color: rgb(204,120,50);">, </span><span style="color: rgb(106,135,89);">"osName"</span><span style="color: rgb(204,120,50);">, </span><span style="color: rgb(106,135,89);">"productName"</span><span style="color: rgb(204,120,50);">, </span><span style="color: rgb(106,135,89);">"buildName"</span><span style="color: rgb(204,120,50);">,<br></span><span style="color: rgb(204,120,50);"> </span><span style="color: rgb(106,135,89);">"versionName"</span><span style="color: rgb(204,120,50);">, </span><span style="color: rgb(106,135,89);">"userNote"</span><span style="color: rgb(204,120,50);">, </span><span style="color: rgb(106,135,89);">"hostName"</span><span style="color: rgb(204,120,50);">, </span><span style="color: rgb(106,135,89);">"timestamp"</span>]<br>START_SUITE_KEYS = [<span style="color: rgb(106,135,89);">"suiteName"</span><span style="color: rgb(204,120,50);">, </span><span style="color: rgb(106,135,89);">"packageName"</span><span style="color: rgb(204,120,50);">, </span><span style="color: rgb(106,135,89);">"timestamp"</span><span style="color: rgb(204,120,50);">, </span><span style="color: rgb(106,135,89);">"parentId"</span><span style="color: rgb(204,120,50);">, </span><span style="color: rgb(106,135,89);">"parentType"</span><span style="color: rgb(204,120,50);">, </span><span style="color: rgb(106,135,89);">"sessionId"</span>]<br>START_TESTCASE_KEYS = [<span style="color: rgb(106,135,89);">"sessionId"</span><span style="color: rgb(204,120,50);">, </span><span style="color: rgb(106,135,89);">"testcaseName"</span><span style="color: rgb(204,120,50);">, </span><span style="color: rgb(106,135,89);">"scenarioName"</span><span style="color: rgb(204,120,50);">, </span><span style="color: rgb(106,135,89);">"scenarioDescription"</span><span style="color: rgb(204,120,50);">, </span><span style="color: rgb(106,135,89);">"timestamp"</span><span style="color: rgb(204,120,50);">, </span><span style="color: rgb(106,135,89);">"parentId"</span><span style="color: rgb(204,120,50);">,<br></span><span style="color: rgb(204,120,50);"> </span><span style="color: rgb(106,135,89);">"parentType"</span>]<br>INSERT_MESSAGE_KEYS = [<span style="color: rgb(106,135,89);">"sessionId"</span><span style="color: rgb(204,120,50);">, </span><span style="color: rgb(106,135,89);">"machineName"</span><span style="color: rgb(204,120,50);">, </span><span style="color: rgb(106,135,89);">"threadName"</span><span style="color: rgb(204,120,50);">, </span><span style="color: rgb(106,135,89);">"level"</span><span style="color: rgb(204,120,50);">, </span><span style="color: rgb(106,135,89);">"message"</span><span style="color: rgb(204,120,50);">, </span><span style="color: rgb(106,135,89);">"timestamp"</span><span style="color: rgb(204,120,50);">, </span><span style="color: rgb(106,135,89);">"parentId"</span><span style="color: rgb(204,120,50);">,<br></span><span style="color: rgb(204,120,50);"> </span><span style="color: rgb(106,135,89);">"parentType"</span>]<br>INSERT_MESSAGES_KEYS = [<span style="color: rgb(106,135,89);">"sessionId"</span><span style="color: rgb(204,120,50);">, </span><span style="color: rgb(106,135,89);">"parentType"</span><span style="color: rgb(204,120,50);">, </span><span style="color: rgb(106,135,89);">"parentId"</span><span style="color: rgb(204,120,50);">, </span><span style="color: rgb(106,135,89);">"timestamp"</span><span style="color: rgb(204,120,50);">, </span><span style="color: rgb(106,135,89);">"messages"</span>]<br>ADD_RUN_METAINFO_KEYS = [<span style="color: rgb(106,135,89);">"sessionId"</span><span style="color: rgb(204,120,50);">, </span><span style="color: rgb(106,135,89);">"metaKey"</span><span style="color: rgb(204,120,50);">, </span><span style="color: rgb(106,135,89);">"metaValue"</span>]<br>ADD_SCENARIO_METAINFO_KEYS = [<span style="color: rgb(106,135,89);">"sessionId"</span><span style="color: rgb(204,120,50);">, </span><span style="color: rgb(106,135,89);">"parentId"</span><span style="color: rgb(204,120,50);">, </span><span style="color: rgb(106,135,89);">"metaKey"</span><span style="color: rgb(204,120,50);">, </span><span style="color: rgb(106,135,89);">"metaValue"</span>]<br>UPDATE_RUN_KEYS = [<span style="color: rgb(106,135,89);">"sessionId"</span><span style="color: rgb(204,120,50);">, </span><span style="color: rgb(106,135,89);">"runName"</span><span style="color: rgb(204,120,50);">, </span><span style="color: rgb(106,135,89);">"osName"</span><span style="color: rgb(204,120,50);">, </span><span style="color: rgb(106,135,89);">"productName"</span><span style="color: rgb(204,120,50);">, </span><span style="color: rgb(106,135,89);">"buildName"</span><span style="color: rgb(204,120,50);">, </span><span style="color: rgb(106,135,89);">"versionName"</span><span style="color: rgb(204,120,50);">, </span><span style="color: rgb(106,135,89);">"userNote"</span><span style="color: rgb(204,120,50);">, </span><span style="color: rgb(106,135,89);">"hostName"</span>]<br>UPDATE_SUITE_KEYS = [<span style="color: rgb(106,135,89);">"sessionId"</span><span style="color: rgb(204,120,50);">, </span><span style="color: rgb(106,135,89);">"suiteId"</span><span style="color: rgb(204,120,50);">, </span><span style="color: rgb(106,135,89);">"suiteName"</span><span style="color: rgb(204,120,50);">, </span><span style="color: rgb(106,135,89);">"userNote"</span>]<br>END_TESTCASE_KEYS = [<span style="color: rgb(106,135,89);">"sessionId"</span><span style="color: rgb(204,120,50);">, </span><span style="color: rgb(106,135,89);">"result"</span><span style="color: rgb(204,120,50);">, </span><span style="color: rgb(106,135,89);">"timestamp"</span><span style="color: rgb(204,120,50);">, </span><span style="color: rgb(106,135,89);">"testcaseId"</span>]<br>END_SUITE_KEYS = [<span style="color: rgb(106,135,89);">"suiteId"</span><span style="color: rgb(204,120,50);">, </span><span style="color: rgb(106,135,89);">"sessionId"</span><span style="color: rgb(204,120,50);">, </span><span style="color: rgb(106,135,89);">"timestamp"</span>]<br>END_RUN_KEYS = [<span style="color: rgb(106,135,89);">"sessionId"</span><span style="color: rgb(204,120,50);">, </span><span style="color: rgb(106,135,89);">"timestamp"</span>]<br><br><span style="color: rgb(128,128,128);"># enable logging of message on each HTTP method execution<br></span>DEBUG = <span style="color: rgb(204,120,50);">False<br></span><span style="color: rgb(204,120,50);"><br></span><span style="color: rgb(204,120,50);"><br></span><span style="color: rgb(128,128,128);"># this function will additionally process the json value<br></span><span style="color: rgb(204,120,50);">def </span><span style="color: rgb(255,198,109);">check_json_value</span>(value):<br>    <span style="color: rgb(204,120,50);">if </span>value <span style="color: rgb(204,120,50);">is None</span>:<br>        <span style="color: rgb(204,120,50);">return </span><span style="color: rgb(106,135,89);">"null"<br></span><span style="color: rgb(106,135,89);"> </span><span style="color: rgb(204,120,50);">elif </span><span style="color: rgb(136,136,198);">type</span>(value) <span style="color: rgb(204,120,50);">is </span><span style="color: rgb(136,136,198);">list</span>:<br>        <span style="color: rgb(204,120,50);">return </span>json.dumps(value)<br>    <span style="color: rgb(204,120,50);">else</span>:<br>        <span style="color: rgb(204,120,50);">return </span><span style="color: rgb(106,135,89);">"</span><span style="color: rgb(204,120,50);">\"</span><span style="color: rgb(106,135,89);">" </span>+ value + <span style="color: rgb(106,135,89);">"</span><span style="color: rgb(204,120,50);">\"</span><span style="color: rgb(106,135,89);">"<br></span><span style="color: rgb(106,135,89);"><br></span><span style="color: rgb(106,135,89);"><br></span><span style="color: rgb(128,128,128);"># this can be replaced with the built-in JSON functionality<br></span><span style="color: rgb(204,120,50);">def </span><span style="color: rgb(255,198,109);">create_json</span>(keys<span style="color: rgb(204,120,50);">, </span>values):<br>    json_data = <span style="color: rgb(106,135,89);">"{"<br></span><span style="color: rgb(106,135,89);"> </span><span style="color: rgb(204,120,50);">for </span>idx <span style="color: rgb(204,120,50);">in </span><span style="color: rgb(136,136,198);">range</span>(<span style="color: rgb(136,136,198);">len</span>(keys)):<br>        json_data += <span style="color: rgb(106,135,89);">"</span><span style="color: rgb(204,120,50);">\"</span><span style="color: rgb(106,135,89);">" </span>+ keys[idx] + <span style="color: rgb(106,135,89);">"</span><span style="color: rgb(204,120,50);">\"</span><span style="color: rgb(106,135,89);">:" </span>+ check_json_value(values[idx]) + <span style="color: rgb(106,135,89);">","<br></span><span style="color: rgb(106,135,89);"> </span>json_data = json_data[<span style="color: rgb(104,151,187);">0</span>:<span style="color: rgb(136,136,198);">len</span>(json_data) - <span style="color: rgb(104,151,187);">1</span>]  <span style="color: rgb(128,128,128);"># remove trailing comma<br></span><span style="color: rgb(128,128,128);"> </span>json_data += <span style="color: rgb(106,135,89);">"}"<br></span><span style="color: rgb(106,135,89);"> </span><span style="color: rgb(204,120,50);">return </span>json_data<br><br><br><span style="color: rgb(204,120,50);">def </span><span style="color: rgb(255,198,109);">do_http_method</span>(method_name<span style="color: rgb(204,120,50);">, </span>base_url<span style="color: rgb(204,120,50);">, </span>rel_url<span style="color: rgb(204,120,50);">, </span>headers={}<span style="color: rgb(204,120,50);">, </span>body=<span style="color: rgb(204,120,50);">None</span>):<br>    <span style="color: rgb(204,120,50);">if </span>DEBUG:<br>        <span style="color: rgb(136,136,198);">print</span>(<span style="color: rgb(106,135,89);">"Executing '{}' HTTP method to URL '{}' with headers '{}' and body '{}'"</span>.format(method_name<span style="color: rgb(204,120,50);">,<br></span><span style="color: rgb(204,120,50);"> </span>base_url + rel_url<span style="color: rgb(204,120,50);">,<br></span><span style="color: rgb(204,120,50);"> </span>headers<span style="color: rgb(204,120,50);">, </span>body))<br>    conn = http.client.HTTPConnection(base_url)<br>    conn.request(method_name<span style="color: rgb(204,120,50);">, </span>rel_url<span style="color: rgb(204,120,50);">, </span>body<span style="color: rgb(204,120,50);">, </span>headers)<br>    resp = conn.getresponse()<br>    conn.close()<br>    <span style="color: rgb(204,120,50);">return </span>resp<br><br><br><span style="color: rgb(204,120,50);">def </span><span style="color: rgb(255,198,109);">http_post</span>(base_url<span style="color: rgb(204,120,50);">, </span>rel_url<span style="color: rgb(204,120,50);">, </span>headers<span style="color: rgb(204,120,50);">, </span>body):<br>    <span style="color: rgb(204,120,50);">return </span>do_http_method(<span style="color: rgb(106,135,89);">"POST"</span><span style="color: rgb(204,120,50);">, </span>base_url<span style="color: rgb(204,120,50);">, </span>rel_url<span style="color: rgb(204,120,50);">, </span>headers<span style="color: rgb(204,120,50);">, </span>body)<br><br><br><span style="color: rgb(204,120,50);">def </span><span style="color: rgb(255,198,109);">http_get</span>(base_url<span style="color: rgb(204,120,50);">, </span>rel_url<span style="color: rgb(204,120,50);">, </span>headers):<br>    <span style="color: rgb(204,120,50);">return </span>do_http_method(<span style="color: rgb(106,135,89);">"GET"</span><span style="color: rgb(204,120,50);">, </span>base_url<span style="color: rgb(204,120,50);">, </span>rel_url<span style="color: rgb(204,120,50);">, </span>headers)<br><br><br><span style="color: rgb(204,120,50);">def </span><span style="color: rgb(255,198,109);">http_put</span>(base_url<span style="color: rgb(204,120,50);">, </span>rel_url<span style="color: rgb(204,120,50);">, </span>headers<span style="color: rgb(204,120,50);">, </span>body):<br>    <span style="color: rgb(204,120,50);">return </span>do_http_method(<span style="color: rgb(106,135,89);">"PUT"</span><span style="color: rgb(204,120,50);">, </span>base_url<span style="color: rgb(204,120,50);">, </span>rel_url<span style="color: rgb(204,120,50);">, </span>headers<span style="color: rgb(204,120,50);">, </span>body)<br><br><br><span style="color: rgb(204,120,50);">def </span><span style="color: rgb(255,198,109);">start_run</span>(db_host<span style="color: rgb(204,120,50);">, </span>db_name<span style="color: rgb(204,120,50);">, </span>db_user<span style="color: rgb(204,120,50);">, </span>db_password<span style="color: rgb(204,120,50);">, </span>run_name<span style="color: rgb(204,120,50);">, </span>os_name<span style="color: rgb(204,120,50);">, </span>product_name<span style="color: rgb(204,120,50);">, </span>build_name<span style="color: rgb(204,120,50);">, </span>version_name<span style="color: rgb(204,120,50);">,<br></span><span style="color: rgb(204,120,50);"> </span>user_note<span style="color: rgb(204,120,50);">, </span>host_name<span style="color: rgb(204,120,50);">, </span>timestamp):<br>    rel_url = HTTP_DB_LOGGER_LOGGER_URL + <span style="color: rgb(106,135,89);">"/" </span>+ START_RUN_REL_URL<br>    headers = {<span style="color: rgb(106,135,89);">"Content-type"</span>: <span style="color: rgb(106,135,89);">"application/json"</span><span style="color: rgb(204,120,50);">, </span><span style="color: rgb(106,135,89);">"Accept"</span>: <span style="color: rgb(106,135,89);">"application/json"</span>}<br>    body = create_json(START_RUN_KEYS<span style="color: rgb(204,120,50);">,<br></span><span style="color: rgb(204,120,50);"> </span>[db_host<span style="color: rgb(204,120,50);">, </span>db_name<span style="color: rgb(204,120,50);">, </span>db_user<span style="color: rgb(204,120,50);">, </span>db_password<span style="color: rgb(204,120,50);">, </span>run_name<span style="color: rgb(204,120,50);">, </span>os_name<span style="color: rgb(204,120,50);">, </span>product_name<span style="color: rgb(204,120,50);">, </span>build_name<span style="color: rgb(204,120,50);">,<br></span><span style="color: rgb(204,120,50);"> </span>version_name<span style="color: rgb(204,120,50);">, </span>user_note<span style="color: rgb(204,120,50);">, </span>host_name<span style="color: rgb(204,120,50);">, </span>timestamp])<br>    <span style="color: rgb(204,120,50);">return </span>http_post(WEBSERVER_URL<span style="color: rgb(204,120,50);">, </span>rel_url<span style="color: rgb(204,120,50);">, </span>headers<span style="color: rgb(204,120,50);">, </span>body)<br><br><br><span style="color: rgb(204,120,50);">def </span><span style="color: rgb(255,198,109);">start_suite</span>(suite_name<span style="color: rgb(204,120,50);">, </span>package_name<span style="color: rgb(204,120,50);">, </span>timestamp<span style="color: rgb(204,120,50);">, </span>parent_id<span style="color: rgb(204,120,50);">, </span>parent_type<span style="color: rgb(204,120,50);">, </span>session_id):<br>    rel_url = HTTP_DB_LOGGER_LOGGER_URL + <span style="color: rgb(106,135,89);">"/" </span>+ START_SUITE_REL_URL<br>    headers = {<span style="color: rgb(106,135,89);">"Content-type"</span>: <span style="color: rgb(106,135,89);">"application/json"</span><span style="color: rgb(204,120,50);">, </span><span style="color: rgb(106,135,89);">"Accept"</span>: <span style="color: rgb(106,135,89);">"application/json"</span>}<br>    body = create_json(START_SUITE_KEYS<span style="color: rgb(204,120,50);">, </span>[suite_name<span style="color: rgb(204,120,50);">, </span>package_name<span style="color: rgb(204,120,50);">, </span>timestamp<span style="color: rgb(204,120,50);">, </span>parent_id<span style="color: rgb(204,120,50);">, </span>parent_type<span style="color: rgb(204,120,50);">, </span>session_id])<br>    <span style="color: rgb(204,120,50);">return </span>http_post(WEBSERVER_URL<span style="color: rgb(204,120,50);">, </span>rel_url<span style="color: rgb(204,120,50);">, </span>headers<span style="color: rgb(204,120,50);">, </span>body)<br><br><br><span style="color: rgb(204,120,50);">def </span><span style="color: rgb(255,198,109);">start_testcase</span>(session_id<span style="color: rgb(204,120,50);">, </span>testcase_name<span style="color: rgb(204,120,50);">, </span>scenario_name<span style="color: rgb(204,120,50);">, </span>description<span style="color: rgb(204,120,50);">, </span>timestamp<span style="color: rgb(204,120,50);">, </span>parent_id<span style="color: rgb(204,120,50);">, </span>parent_type):<br>    rel_url = HTTP_DB_LOGGER_LOGGER_URL + <span style="color: rgb(106,135,89);">"/" </span>+ START_TESTCASE_REL_URL<br>    headers = {<span style="color: rgb(106,135,89);">"Content-type"</span>: <span style="color: rgb(106,135,89);">"application/json"</span><span style="color: rgb(204,120,50);">, </span><span style="color: rgb(106,135,89);">"Accept"</span>: <span style="color: rgb(106,135,89);">"application/json"</span>}<br>    body = create_json(START_TESTCASE_KEYS<span style="color: rgb(204,120,50);">,<br></span><span style="color: rgb(204,120,50);"> </span>[session_id<span style="color: rgb(204,120,50);">, </span>testcase_name<span style="color: rgb(204,120,50);">, </span>scenario_name<span style="color: rgb(204,120,50);">, </span>description<span style="color: rgb(204,120,50);">, </span>timestamp<span style="color: rgb(204,120,50);">, </span>parent_id<span style="color: rgb(204,120,50);">, </span>parent_type])<br>    <span style="color: rgb(204,120,50);">return </span>http_post(WEBSERVER_URL<span style="color: rgb(204,120,50);">, </span>rel_url<span style="color: rgb(204,120,50);">, </span>headers<span style="color: rgb(204,120,50);">, </span>body)<br><br><br><span style="color: rgb(204,120,50);">def </span><span style="color: rgb(255,198,109);">end_testcase</span>(session_id<span style="color: rgb(204,120,50);">, </span>result<span style="color: rgb(204,120,50);">, </span>timestamp<span style="color: rgb(204,120,50);">, </span>testcase_id):<br>    rel_url = HTTP_DB_LOGGER_LOGGER_URL + <span style="color: rgb(106,135,89);">"/" </span>+ END_TESTCASE_REL_URL<br>    headers = {<span style="color: rgb(106,135,89);">"Content-type"</span>: <span style="color: rgb(106,135,89);">"application/json"</span><span style="color: rgb(204,120,50);">, </span><span style="color: rgb(106,135,89);">"Accept"</span>: <span style="color: rgb(106,135,89);">"application/json"</span>}<br>    body = create_json(END_TESTCASE_KEYS<span style="color: rgb(204,120,50);">, </span>[session_id<span style="color: rgb(204,120,50);">, </span>result<span style="color: rgb(204,120,50);">, </span>timestamp<span style="color: rgb(204,120,50);">, </span>testcase_id])<br>    <span style="color: rgb(204,120,50);">return </span>http_post(WEBSERVER_URL<span style="color: rgb(204,120,50);">, </span>rel_url<span style="color: rgb(204,120,50);">, </span>headers<span style="color: rgb(204,120,50);">, </span>body)<br><br><br><span style="color: rgb(204,120,50);">def </span><span style="color: rgb(255,198,109);">end_suite</span>(suite_id<span style="color: rgb(204,120,50);">, </span>session_id<span style="color: rgb(204,120,50);">, </span>timestamp):<br>    rel_url = HTTP_DB_LOGGER_LOGGER_URL + <span style="color: rgb(106,135,89);">"/" </span>+ END_SUITE_REL_URL<br>    headers = {<span style="color: rgb(106,135,89);">"Content-type"</span>: <span style="color: rgb(106,135,89);">"application/json"</span><span style="color: rgb(204,120,50);">, </span><span style="color: rgb(106,135,89);">"Accept"</span>: <span style="color: rgb(106,135,89);">"application/json"</span>}<br>    body = create_json(END_SUITE_KEYS<span style="color: rgb(204,120,50);">, </span>[suite_id<span style="color: rgb(204,120,50);">, </span>session_id<span style="color: rgb(204,120,50);">, </span>timestamp])<br>    <span style="color: rgb(204,120,50);">return </span>http_post(WEBSERVER_URL<span style="color: rgb(204,120,50);">, </span>rel_url<span style="color: rgb(204,120,50);">, </span>headers<span style="color: rgb(204,120,50);">, </span>body)<br><br><br><span style="color: rgb(204,120,50);">def </span><span style="color: rgb(255,198,109);">end_run</span>(session_id<span style="color: rgb(204,120,50);">, </span>timestamp):<br>    rel_url = HTTP_DB_LOGGER_LOGGER_URL + <span style="color: rgb(106,135,89);">"/" </span>+ END_RUN_REL_URL<br>    headers = {<span style="color: rgb(106,135,89);">"Content-type"</span>: <span style="color: rgb(106,135,89);">"application/json"</span><span style="color: rgb(204,120,50);">, </span><span style="color: rgb(106,135,89);">"Accept"</span>: <span style="color: rgb(106,135,89);">"application/json"</span>}<br>    body = create_json(END_RUN_KEYS<span style="color: rgb(204,120,50);">, </span>[session_id<span style="color: rgb(204,120,50);">, </span>timestamp])<br>    <span style="color: rgb(204,120,50);">return </span>http_post(WEBSERVER_URL<span style="color: rgb(204,120,50);">, </span>rel_url<span style="color: rgb(204,120,50);">, </span>headers<span style="color: rgb(204,120,50);">, </span>body)<br><br><br><span style="color: rgb(204,120,50);">def </span><span style="color: rgb(255,198,109);">insert_message</span>(session_id<span style="color: rgb(204,120,50);">, </span>machine_name<span style="color: rgb(204,120,50);">, </span>thread_name<span style="color: rgb(204,120,50);">, </span>level<span style="color: rgb(204,120,50);">, </span>message<span style="color: rgb(204,120,50);">, </span>timestamp<span style="color: rgb(204,120,50);">, </span>parent_id<span style="color: rgb(204,120,50);">, </span>parent_type):<br>    rel_url = HTTP_DB_LOGGER_LOGGER_URL + <span style="color: rgb(106,135,89);">"/" </span>+ INSERT_MESSAGE_REL_URL<br>    headers = {<span style="color: rgb(106,135,89);">"Content-type"</span>: <span style="color: rgb(106,135,89);">"application/json"</span><span style="color: rgb(204,120,50);">, </span><span style="color: rgb(106,135,89);">"Accept"</span>: <span style="color: rgb(106,135,89);">"application/json"</span>}<br>    body = create_json(INSERT_MESSAGE_KEYS<span style="color: rgb(204,120,50);">,<br></span><span style="color: rgb(204,120,50);"> </span>[session_id<span style="color: rgb(204,120,50);">, </span>machine_name<span style="color: rgb(204,120,50);">, </span>thread_name<span style="color: rgb(204,120,50);">, </span>level<span style="color: rgb(204,120,50);">, </span>message<span style="color: rgb(204,120,50);">, </span>timestamp<span style="color: rgb(204,120,50);">, </span>parent_id<span style="color: rgb(204,120,50);">, </span>parent_type])<br>    <span style="color: rgb(204,120,50);">return </span>http_post(WEBSERVER_URL<span style="color: rgb(204,120,50);">, </span>rel_url<span style="color: rgb(204,120,50);">, </span>headers<span style="color: rgb(204,120,50);">, </span>body)<br><br><br><span style="color: rgb(204,120,50);">def </span><span style="color: rgb(255,198,109);">insert_messages</span>(session_id<span style="color: rgb(204,120,50);">, </span>parent_type<span style="color: rgb(204,120,50);">, </span>parent_id<span style="color: rgb(204,120,50);">, </span>timestamp<span style="color: rgb(204,120,50);">, </span>ins_messages):<br>    rel_url = HTTP_DB_LOGGER_LOGGER_URL + <span style="color: rgb(106,135,89);">"/" </span>+ INSERT_MESSAGES_REL_URL<br>    headers = {<span style="color: rgb(106,135,89);">"Content-type"</span>: <span style="color: rgb(106,135,89);">"application/json"</span><span style="color: rgb(204,120,50);">, </span><span style="color: rgb(106,135,89);">"Accept"</span>: <span style="color: rgb(106,135,89);">"application/json"</span>}<br>    body = create_json(INSERT_MESSAGES_KEYS<span style="color: rgb(204,120,50);">, </span>[session_id<span style="color: rgb(204,120,50);">, </span>parent_type<span style="color: rgb(204,120,50);">, </span>parent_id<span style="color: rgb(204,120,50);">, </span>timestamp<span style="color: rgb(204,120,50);">, </span>ins_messages])<br>    <span style="color: rgb(204,120,50);">return </span>http_post(WEBSERVER_URL<span style="color: rgb(204,120,50);">, </span>rel_url<span style="color: rgb(204,120,50);">, </span>headers<span style="color: rgb(204,120,50);">, </span>body)<br><br><br><span style="color: rgb(204,120,50);">def </span><span style="color: rgb(255,198,109);">update_run</span>(session_id<span style="color: rgb(204,120,50);">, </span>run_name<span style="color: rgb(204,120,50);">, </span>os_name<span style="color: rgb(204,120,50);">, </span>product_name<span style="color: rgb(204,120,50);">, </span>build_name<span style="color: rgb(204,120,50);">, </span>version_name<span style="color: rgb(204,120,50);">, </span>user_note<span style="color: rgb(204,120,50);">, </span>host_name):<br>    rel_url = HTTP_DB_LOGGER_LOGGER_URL + <span style="color: rgb(106,135,89);">"/" </span>+ UPDATE_RUN_REL_URL<br>    headers = {<span style="color: rgb(106,135,89);">"Content-type"</span>: <span style="color: rgb(106,135,89);">"application/json"</span><span style="color: rgb(204,120,50);">, </span><span style="color: rgb(106,135,89);">"Accept"</span>: <span style="color: rgb(106,135,89);">"application/json"</span>}<br>    body = create_json(UPDATE_RUN_KEYS<span style="color: rgb(204,120,50);">,<br></span><span style="color: rgb(204,120,50);"> </span>[session_id<span style="color: rgb(204,120,50);">, </span>run_name<span style="color: rgb(204,120,50);">, </span>os_name<span style="color: rgb(204,120,50);">, </span>product_name<span style="color: rgb(204,120,50);">, </span>build_name<span style="color: rgb(204,120,50);">, </span>version_name<span style="color: rgb(204,120,50);">, </span>user_note<span style="color: rgb(204,120,50);">, </span>host_name])<br>    <span style="color: rgb(204,120,50);">return </span>http_post(WEBSERVER_URL<span style="color: rgb(204,120,50);">, </span>rel_url<span style="color: rgb(204,120,50);">, </span>headers<span style="color: rgb(204,120,50);">, </span>body)<br><br><br><span style="color: rgb(204,120,50);">def </span><span style="color: rgb(255,198,109);">update_suite</span>(session_id<span style="color: rgb(204,120,50);">, </span>suite_id<span style="color: rgb(204,120,50);">, </span>suite_name<span style="color: rgb(204,120,50);">, </span>user_note):<br>    rel_url = HTTP_DB_LOGGER_LOGGER_URL + <span style="color: rgb(106,135,89);">"/" </span>+ UPDATE_SUITE_REL_URL<br>    headers = {<span style="color: rgb(106,135,89);">"Content-type"</span>: <span style="color: rgb(106,135,89);">"application/json"</span><span style="color: rgb(204,120,50);">, </span><span style="color: rgb(106,135,89);">"Accept"</span>: <span style="color: rgb(106,135,89);">"application/json"</span>}<br>    body = create_json(UPDATE_SUITE_KEYS<span style="color: rgb(204,120,50);">, </span>[session_id<span style="color: rgb(204,120,50);">, </span>suite_id<span style="color: rgb(204,120,50);">, </span>suite_name<span style="color: rgb(204,120,50);">, </span>user_note])<br>    <span style="color: rgb(204,120,50);">return </span>http_post(WEBSERVER_URL<span style="color: rgb(204,120,50);">, </span>rel_url<span style="color: rgb(204,120,50);">, </span>headers<span style="color: rgb(204,120,50);">, </span>body)<br><br><br><span style="color: rgb(204,120,50);">def </span><span style="color: rgb(255,198,109);">add_run_meta_info</span>(session_id<span style="color: rgb(204,120,50);">, </span>meta_key<span style="color: rgb(204,120,50);">, </span>meta_value):<br>    rel_url = HTTP_DB_LOGGER_LOGGER_URL + <span style="color: rgb(106,135,89);">"/" </span>+ ADD_RUN_METAINFO_REL_URL<br>    headers = {<span style="color: rgb(106,135,89);">"Content-type"</span>: <span style="color: rgb(106,135,89);">"application/json"</span><span style="color: rgb(204,120,50);">, </span><span style="color: rgb(106,135,89);">"Accept"</span>: <span style="color: rgb(106,135,89);">"application/json"</span>}<br>    body = create_json(ADD_RUN_METAINFO_KEYS<span style="color: rgb(204,120,50);">, </span>[session_id<span style="color: rgb(204,120,50);">, </span>meta_key<span style="color: rgb(204,120,50);">, </span>meta_value])<br>    <span style="color: rgb(204,120,50);">return </span>http_post(WEBSERVER_URL<span style="color: rgb(204,120,50);">, </span>rel_url<span style="color: rgb(204,120,50);">, </span>headers<span style="color: rgb(204,120,50);">, </span>body)<br><br><br><span style="color: rgb(204,120,50);">def </span><span style="color: rgb(255,198,109);">add_scenario_meta_info</span>(session_id<span style="color: rgb(204,120,50);">, </span>testcase_id<span style="color: rgb(204,120,50);">, </span>meta_key<span style="color: rgb(204,120,50);">, </span>meta_value):<br>    rel_url = HTTP_DB_LOGGER_LOGGER_URL + <span style="color: rgb(106,135,89);">"/" </span>+ ADD_SCENARIO_METAINFO_REL_URL<br>    headers = {<span style="color: rgb(106,135,89);">"Content-type"</span>: <span style="color: rgb(106,135,89);">"application/json"</span><span style="color: rgb(204,120,50);">, </span><span style="color: rgb(106,135,89);">"Accept"</span>: <span style="color: rgb(106,135,89);">"application/json"</span>}<br>    body = create_json(ADD_SCENARIO_METAINFO_KEYS<span style="color: rgb(204,120,50);">, </span>[session_id<span style="color: rgb(204,120,50);">, </span>testcase_id<span style="color: rgb(204,120,50);">, </span>meta_key<span style="color: rgb(204,120,50);">, </span>meta_value])<br>    <span style="color: rgb(204,120,50);">return </span>http_post(WEBSERVER_URL<span style="color: rgb(204,120,50);">, </span>rel_url<span style="color: rgb(204,120,50);">, </span>headers<span style="color: rgb(204,120,50);">, </span>body)<br><br><br><span style="color: rgb(204,120,50);">def </span><span style="color: rgb(255,198,109);">attach_file</span>(session_id<span style="color: rgb(204,120,50);">, </span>testcase_id<span style="color: rgb(204,120,50);">, </span>file_path<span style="color: rgb(204,120,50);">, </span>file_name):<br>    rel_url = HTTP_DB_LOGGER_LOGGER_URL + <span style="color: rgb(106,135,89);">"/" </span>+ ATTACH_FILE<br>    headers = {<span style="color: rgb(106,135,89);">"Content-type"</span>: <span style="color: rgb(106,135,89);">"application/octet-stream"</span><span style="color: rgb(204,120,50);">, </span><span style="color: rgb(106,135,89);">"sessionId"</span>: session_id<span style="color: rgb(204,120,50);">, </span><span style="color: rgb(106,135,89);">"testcaseId"</span>: testcase_id<span style="color: rgb(204,120,50);">,<br></span><span style="color: rgb(204,120,50);"> </span><span style="color: rgb(106,135,89);">"fileName"</span>: file_name}<br>    <span style="color: rgb(204,120,50);">return </span>http_put(WEBSERVER_URL<span style="color: rgb(204,120,50);">, </span>rel_url<span style="color: rgb(204,120,50);">, </span>headers<span style="color: rgb(204,120,50);">, </span><span style="color: rgb(136,136,198);">open</span>(file_path))<br><br><br><span style="color: rgb(128,128,128);"># variables for storing responses' data<br></span>sessionId = <span style="color: rgb(204,120,50);">None<br></span>runIds = []<br>suiteIds = []<br>testcaseIds = []<br><br><span style="color: rgb(128,128,128);"># start a run<br></span>response = start_run(<span style="color: rgb(106,135,89);">"localhost"</span><span style="color: rgb(204,120,50);">, </span><span style="color: rgb(106,135,89);">"TestDb"</span><span style="color: rgb(204,120,50);">, </span><span style="color: rgb(106,135,89);">"AtsUser"</span><span style="color: rgb(204,120,50);">, </span><span style="color: rgb(106,135,89);">"AtsPassword"</span><span style="color: rgb(204,120,50);">, </span><span style="color: rgb(106,135,89);">"testRun1"</span><span style="color: rgb(204,120,50);">, </span><span style="color: rgb(106,135,89);">"LINUX"</span><span style="color: rgb(204,120,50);">, </span><span style="color: rgb(106,135,89);">"Ats HttpDbLogger"</span><span style="color: rgb(204,120,50);">, </span><span style="color: rgb(106,135,89);">"1"</span><span style="color: rgb(204,120,50);">,<br></span><span style="color: rgb(204,120,50);"> </span><span style="color: rgb(106,135,89);">"4.0.2-SN"</span><span style="color: rgb(204,120,50);">, </span><span style="color: rgb(106,135,89);">"first run"</span><span style="color: rgb(204,120,50);">, </span><span style="color: rgb(106,135,89);">"ds-ws"</span><span style="color: rgb(204,120,50);">, </span><span style="color: rgb(106,135,89);">"-1"</span>)<br>sessiond = response.info()[<span style="color: rgb(106,135,89);">'sessionId'</span>]<br>runId = response.info()[<span style="color: rgb(106,135,89);">'runId'</span>]<br>runIds.append(runId)<br><br><span style="color: rgb(128,128,128);"># start a suite<br></span>response = start_suite(<span style="color: rgb(106,135,89);">"SuiteOne"</span><span style="color: rgb(204,120,50);">, </span><span style="color: rgb(106,135,89);">"com.example.ats"</span><span style="color: rgb(204,120,50);">, </span><span style="color: rgb(106,135,89);">"-1"</span><span style="color: rgb(204,120,50);">, </span><span style="color: rgb(106,135,89);">"-1"</span><span style="color: rgb(204,120,50);">, </span><span style="color: rgb(106,135,89);">"RUN"</span><span style="color: rgb(204,120,50);">, </span>sessionId)<br>suiteId = response.info()[<span style="color: rgb(106,135,89);">'suiteId'</span>]<br>suiteIds.append(suiteId)<br><br><span style="color: rgb(128,128,128);"># start a testcase<br></span>response = start_testcase(sessionId<span style="color: rgb(204,120,50);">, </span><span style="color: rgb(106,135,89);">"TestCase1"</span><span style="color: rgb(204,120,50);">, </span><span style="color: rgb(106,135,89);">"Scenario1"</span><span style="color: rgb(204,120,50);">, </span><span style="color: rgb(106,135,89);">"The first scenario/testcase"</span><span style="color: rgb(204,120,50);">, </span><span style="color: rgb(106,135,89);">"-1"</span><span style="color: rgb(204,120,50);">, </span><span style="color: rgb(106,135,89);">"-1"</span><span style="color: rgb(204,120,50);">, </span><span style="color: rgb(106,135,89);">"SUITE"</span>)<br>testcaseId = response.info()[<span style="color: rgb(106,135,89);">'testcaseId'</span>]<br>testcaseIds.append(testcaseId)<br><br><span style="color: rgb(128,128,128);"># insert single run and suite message<br></span>insert_message(sessionId<span style="color: rgb(204,120,50);">, </span><span style="color: rgb(106,135,89);">"ds-ws"</span><span style="color: rgb(204,120,50);">, </span><span style="color: rgb(106,135,89);">"main"</span><span style="color: rgb(204,120,50);">, </span><span style="color: rgb(106,135,89);">"INFO"</span><span style="color: rgb(204,120,50);">, </span><span style="color: rgb(106,135,89);">"Some run message with log level INFO"</span><span style="color: rgb(204,120,50);">, </span><span style="color: rgb(106,135,89);">"-1"</span><span style="color: rgb(204,120,50);">, </span><span style="color: rgb(136,136,198);">str</span>(runId)<span style="color: rgb(204,120,50);">, </span><span style="color: rgb(106,135,89);">"RUN"</span>)<br><span style="color: rgb(204,120,50);">for </span>suiteId <span style="color: rgb(204,120,50);">in </span>suiteIds:<br>    insert_message(sessionId<span style="color: rgb(204,120,50);">, </span><span style="color: rgb(106,135,89);">"ds-ws"</span><span style="color: rgb(204,120,50);">, </span><span style="color: rgb(106,135,89);">"main"</span><span style="color: rgb(204,120,50);">, </span><span style="color: rgb(106,135,89);">"INFO"</span><span style="color: rgb(204,120,50);">, </span><span style="color: rgb(106,135,89);">"Some suite message with log level INFO"</span><span style="color: rgb(204,120,50);">, </span><span style="color: rgb(106,135,89);">"-1"</span><span style="color: rgb(204,120,50);">, </span><span style="color: rgb(136,136,198);">str</span>(suiteId)<span style="color: rgb(204,120,50);">,<br></span><span style="color: rgb(204,120,50);"> </span><span style="color: rgb(106,135,89);">"SUITE"</span>)<br><br><span style="color: rgb(128,128,128);"># attach file to the current testcase<br></span>attach_file(sessionId<span style="color: rgb(204,120,50);">, </span>testcaseId<span style="color: rgb(204,120,50);">, </span><span style="color: rgb(106,135,89);">"D:</span><span style="color: rgb(204,120,50);">\\</span><span style="color: rgb(106,135,89);">test.txt"</span><span style="color: rgb(204,120,50);">, </span><span style="color: rgb(106,135,89);">"test.txt"</span>)<br><br><span style="color: rgb(128,128,128);"># simulate some work by sleeping for 1 minute<br></span><span style="color: rgb(128,128,128);"># os.system("sleep 60")<br></span><span style="color: rgb(128,128,128);"><br></span><span style="color: rgb(128,128,128);"># end all testcases<br></span><span style="color: rgb(128,128,128);"># in order to do that, we have to disable/skip the default event state checking<br></span><span style="color: rgb(128,128,128);"># and this is done by simply providing testcaseId, instead of -1<br></span><span style="color: rgb(128,128,128);"># now instead of checking whether we can end a testcase<br></span><span style="color: rgb(128,128,128);"># the HttpDbLogger will just check if the testcase, which we want to end is indeed already running and whether <br></span><span style="color: rgb(128,128,128);"># it was started by the current session<br></span><span style="color: rgb(204,120,50);">for </span>testcaseId <span style="color: rgb(204,120,50);">in </span>testcaseIds:<br>    end_testcase(sessionId<span style="color: rgb(204,120,50);">, </span><span style="color: rgb(106,135,89);">"PASSED"</span><span style="color: rgb(204,120,50);">, </span><span style="color: rgb(106,135,89);">"-1"</span><span style="color: rgb(204,120,50);">, </span><span style="color: rgb(136,136,198);">str</span>(testcaseId))  <span style="color: rgb(128,128,128);"># here we are providing the testcaseId<br></span><span style="color: rgb(128,128,128);"><br></span><span style="color: rgb(128,128,128);"># insert more than one message for the first testcase<br></span><span style="color: rgb(128,128,128);"># as you can see, by providing parentType and parentId,<br></span><span style="color: rgb(128,128,128);"># we can insert messages in already ended/closed testcases<br></span><span style="color: rgb(128,128,128);"># we also provide custom time stamp, which is the current time of the test executor <br></span><span style="color: rgb(128,128,128);"># (e.g. our machine where this script will be executed)<br></span>message1 = {<br>    <span style="color: rgb(106,135,89);">'machineName'</span>: <span style="color: rgb(106,135,89);">'ds-ws'</span><span style="color: rgb(204,120,50);">,<br></span><span style="color: rgb(204,120,50);"> </span><span style="color: rgb(106,135,89);">'threadName'</span>: <span style="color: rgb(106,135,89);">'main'</span><span style="color: rgb(204,120,50);">,<br></span><span style="color: rgb(204,120,50);"> </span><span style="color: rgb(106,135,89);">'level'</span>: <span style="color: rgb(106,135,89);">'ERROR'</span><span style="color: rgb(204,120,50);">,<br></span><span style="color: rgb(204,120,50);"> </span><span style="color: rgb(106,135,89);">'message'</span>: <span style="color: rgb(106,135,89);">'1/2 testcase messages logged at once'</span><span style="color: rgb(204,120,50);">,<br></span><span style="color: rgb(204,120,50);"> </span><span style="color: rgb(106,135,89);">'timestamp'</span>: <span style="color: rgb(106,135,89);">'-1'</span><span style="color: rgb(204,120,50);">,<br></span><span style="color: rgb(204,120,50);"> </span><span style="color: rgb(106,135,89);">'parentId'</span>: <span style="color: rgb(136,136,198);">str</span>(testcaseIds[<span style="color: rgb(104,151,187);">0</span>])<span style="color: rgb(204,120,50);">,<br></span><span style="color: rgb(204,120,50);"> </span><span style="color: rgb(106,135,89);">'parentType'</span>: <span style="color: rgb(106,135,89);">'TESTCASE'<br></span>}<br>message2 = {<br>    <span style="color: rgb(106,135,89);">'machineName'</span>: <span style="color: rgb(106,135,89);">'ds-ws'</span><span style="color: rgb(204,120,50);">,<br></span><span style="color: rgb(204,120,50);"> </span><span style="color: rgb(106,135,89);">'threadName'</span>: <span style="color: rgb(106,135,89);">'main'</span><span style="color: rgb(204,120,50);">,<br></span><span style="color: rgb(204,120,50);"> </span><span style="color: rgb(106,135,89);">'level'</span>: <span style="color: rgb(106,135,89);">'ERROR'</span><span style="color: rgb(204,120,50);">,<br></span><span style="color: rgb(204,120,50);"> </span><span style="color: rgb(106,135,89);">'message'</span>: <span style="color: rgb(106,135,89);">'some error testcase message'</span><span style="color: rgb(204,120,50);">,<br></span><span style="color: rgb(204,120,50);"> </span><span style="color: rgb(106,135,89);">'timestamp'</span>: <span style="color: rgb(106,135,89);">'2/2 testcase messages logged at once'</span><span style="color: rgb(204,120,50);">,<br></span><span style="color: rgb(204,120,50);"> </span><span style="color: rgb(106,135,89);">'parentId'</span>: <span style="color: rgb(136,136,198);">str</span>(testcaseIds[<span style="color: rgb(104,151,187);">0</span>])<span style="color: rgb(204,120,50);">,<br></span><span style="color: rgb(204,120,50);"> </span><span style="color: rgb(106,135,89);">'parentType'</span>: <span style="color: rgb(106,135,89);">'TESTCASE'<br></span>}<br>messages = [<br>    message1<span style="color: rgb(204,120,50);">,<br></span><span style="color: rgb(204,120,50);"> </span>message2<br>]  <span style="color: rgb(128,128,128);"># </span><span style="color: rgb(168,192,35);">TODO dump messages list to a valid JSON string<br></span><span style="color: rgb(204,120,50);">for </span>testcaseId <span style="color: rgb(204,120,50);">in </span>testcaseIds:<br>    insert_messages(sessionId<span style="color: rgb(204,120,50);">, </span><span style="color: rgb(106,135,89);">"TESTCASE"</span><span style="color: rgb(204,120,50);">, </span><span style="color: rgb(136,136,198);">str</span>(testcaseId)<span style="color: rgb(204,120,50);">, </span><span style="color: rgb(106,135,89);">"-1"</span><span style="color: rgb(204,120,50);">, </span>messages)<br><br><span style="color: rgb(128,128,128);"># end all suites<br></span><span style="color: rgb(128,128,128);"># again as with the ending of all the testcases,<br></span><span style="color: rgb(128,128,128);"># we are providing suiteId, so the HttpDbLogger will skip any event logging state checking, <br></span><span style="color: rgb(128,128,128);"># check if the requested suite (refered by the suiteId) is started by the current session<br></span><span style="color: rgb(128,128,128);"># and if everything is OK, it will stop the suite<br></span><span style="color: rgb(128,128,128);"># if an error occured, it's cause and Java stacktrace will be returned with the response's body<br></span><span style="color: rgb(204,120,50);">for </span>i <span style="color: rgb(204,120,50);">in </span>suiteIds:<br>    end_suite(<span style="color: rgb(136,136,198);">str</span>(i)<span style="color: rgb(204,120,50);">, </span>sessionId<span style="color: rgb(204,120,50);">, </span><span style="color: rgb(106,135,89);">"-1"</span>)<br><br><span style="color: rgb(128,128,128);"># end the run<br></span>end_run(sessionId<span style="color: rgb(204,120,50);">, </span><span style="color: rgb(106,135,89);">"-1"</span>)<br><br><span style="color: rgb(128,128,128);"># update the already ended run<br></span>update_run(sessionId<span style="color: rgb(204,120,50);">, </span><span style="color: rgb(106,135,89);">"New testRun1"</span><span style="color: rgb(204,120,50);">, None, None, None, None, None, </span><span style="color: rgb(106,135,89);">"my workstation at home"</span>)<br><br><span style="color: rgb(128,128,128);"># update each suite, that was started by this session<br></span><span style="color: rgb(204,120,50);">for </span>suiteId <span style="color: rgb(204,120,50);">in </span>suiteIds:<br>    update_suite(sessionId<span style="color: rgb(204,120,50);">, </span><span style="color: rgb(136,136,198);">str</span>(suiteId)<span style="color: rgb(204,120,50);">, </span><span style="color: rgb(106,135,89);">"Some new suite name for suite with ID " </span>+ <span style="color: rgb(136,136,198);">str</span>(i)<span style="color: rgb(204,120,50);">, </span><span style="color: rgb(106,135,89);">"Suite with ID " </span>+ <span style="color: rgb(136,136,198);">str</span>(i))<br><br><span style="color: rgb(128,128,128);"># add run metainfo<br></span><span style="color: rgb(128,128,128);"># currently the only available metaKey value is type<br></span>add_run_meta_info(sessionId<span style="color: rgb(204,120,50);">, </span><span style="color: rgb(106,135,89);">"type"</span><span style="color: rgb(204,120,50);">, </span><span style="color: rgb(106,135,89);">"progression"</span>)<br><br><span style="color: rgb(128,128,128);"># add scenario metainfo for each testcase<br></span><span style="color: rgb(204,120,50);">for </span>testcaseId <span style="color: rgb(204,120,50);">in </span>testcaseIds:<br>    <span style="color: rgb(204,120,50);">if </span><span style="color: rgb(136,136,198);">int</span>(i) % <span style="color: rgb(104,151,187);">2 </span>== <span style="color: rgb(104,151,187);">0</span>:<br>        add_scenario_meta_info(sessionId<span style="color: rgb(204,120,50);">, </span><span style="color: rgb(136,136,198);">str</span>(testcaseId)<span style="color: rgb(204,120,50);">, </span><span style="color: rgb(106,135,89);">"group"</span><span style="color: rgb(204,120,50);">, </span><span style="color: rgb(106,135,89);">"even"</span>)<br>    <span style="color: rgb(204,120,50);">else</span>:<br>        add_scenario_meta_info(sessionId<span style="color: rgb(204,120,50);">, </span><span style="color: rgb(136,136,198);">str</span>(testcaseId)<span style="color: rgb(204,120,50);">, </span><span style="color: rgb(106,135,89);">"group"</span><span style="color: rgb(204,120,50);">, </span><span style="color: rgb(106,135,89);">"odd"</span>)</pre>
      <p><br></p>
      <hr>
      <p>Go to&nbsp;<a href="ATS-HTTP-DB-Logger-Guide.html">parent page</a><p>Go to <a href="./toc.html">Table of Contents</a></p></p>
      <hr>
      <p><br></p> 
     </div> 
    </div> 
   </div> 
  </div>
 </body>
</html>