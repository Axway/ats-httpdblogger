<!DOCTYPE html>
<html>
    <head>
        <title>ATS : Using the HTTP DB Logger&#39;s API via Python</title>
        <link rel="stylesheet" href="styles/site.css" type="text/css" />
        <META http-equiv="Content-Type" content="text/html; charset=UTF-8">
    </head>

    <body class="theme-default aui-theme-default">
        <div id="page">
            <div id="main" class="aui-page-panel">
                <div id="main-header">
<a><img class="axway_logo" src="images/AxwayLogo.png" alt="Axway Inc"></a>

                    <div id="breadcrumb-section">
                        <ol id="breadcrumbs">
                            <li class="first">
                                <span><a href="index.html">ATS</a></span>
                            </li>
                                                    <li>
                                <span><a href="Using-the-HTTP-DB-Logger.html">Using the HTTP DB Logger</a></span>
                            </li>
                                                </ol>
                    </div>
                    <h1 id="title-heading" class="pagetitle">
                                                <span id="title-text">
                            ATS : Using the HTTP DB Logger&#39;s API via Python
                        </span>
                    </h1>
                </div>

                <div id="content" class="view">
                    
                    <div id="main-content" class="wiki-content group">
                    <pre><span style="color: rgb(128,128,128);">#!/usr/bin/python3<br/></span><span style="color: rgb(128,128,128);"><br/></span><span style="color: rgb(204,120,50);">import </span>http.client<br/><span style="color: rgb(204,120,50);">import </span>json<br/><br/><span style="color: rgb(128,128,128);"># HttpDbLogger application host (it will be some kind of Java applications server - Tomcat/Jetty/etc<br/></span>WEBSERVER_URL = <span style="color: rgb(106,135,89);">&quot;127.0.0.1:8080&quot;<br/></span><span style="color: rgb(128,128,128);"># ats-httpdblogger-4.0.2-SNAPSHOT is the name of the deployed .war file<br/></span><span style="color: rgb(128,128,128);"># and /service/logger is the full path to the logger sevice<br/></span>HTTP_DB_LOGGER_LOGGER_URL = <span style="color: rgb(106,135,89);">&quot;/ats-httpdblogger-4.0.2-SNAPSHOT/service/logger&quot;<br/></span><span style="color: rgb(106,135,89);"><br/></span><span style="color: rgb(128,128,128);"># Relative URLs for each logging operation<br/></span>START_RUN_REL_URL = <span style="color: rgb(106,135,89);">&quot;start_run&quot;<br/></span>START_SUITE_REL_URL = <span style="color: rgb(106,135,89);">&quot;start_suite&quot;<br/></span>START_TESTCASE_REL_URL = <span style="color: rgb(106,135,89);">&quot;start_testcase&quot;<br/></span>INSERT_MESSAGE_REL_URL = <span style="color: rgb(106,135,89);">&quot;insertMessage&quot;<br/></span>INSERT_MESSAGES_REL_URL = <span style="color: rgb(106,135,89);">&quot;insertMessages&quot;<br/></span>ADD_RUN_METAINFO_REL_URL = <span style="color: rgb(106,135,89);">&quot;add_run_meta_info&quot;<br/></span>ADD_SCENARIO_METAINFO_REL_URL = <span style="color: rgb(106,135,89);">&quot;add_scenario_meta_info&quot;<br/></span>UPDATE_RUN_REL_URL = <span style="color: rgb(106,135,89);">&quot;update_run&quot;<br/></span>UPDATE_SUITE_REL_URL = <span style="color: rgb(106,135,89);">&quot;update_suite&quot;<br/></span>END_TESTCASE_REL_URL = <span style="color: rgb(106,135,89);">&quot;end_testcase&quot;<br/></span>END_SUITE_REL_URL = <span style="color: rgb(106,135,89);">&quot;end_suite&quot;<br/></span>END_RUN_REL_URL = <span style="color: rgb(106,135,89);">&quot;end_run&quot;<br/></span>ATTACH_FILE = <span style="color: rgb(106,135,89);">&quot;attachFile&quot;<br/></span><span style="color: rgb(106,135,89);"><br/></span><span style="color: rgb(128,128,128);"># JSON keys, used in the creation of the requests' bodies<br/></span>START_RUN_KEYS = [<span style="color: rgb(106,135,89);">&quot;dbHost&quot;</span><span style="color: rgb(204,120,50);">, </span><span style="color: rgb(106,135,89);">&quot;dbName&quot;</span><span style="color: rgb(204,120,50);">, </span><span style="color: rgb(106,135,89);">&quot;dbUser&quot;</span><span style="color: rgb(204,120,50);">, </span><span style="color: rgb(106,135,89);">&quot;dbPassword&quot;</span><span style="color: rgb(204,120,50);">, </span><span style="color: rgb(106,135,89);">&quot;runName&quot;</span><span style="color: rgb(204,120,50);">, </span><span style="color: rgb(106,135,89);">&quot;osName&quot;</span><span style="color: rgb(204,120,50);">, </span><span style="color: rgb(106,135,89);">&quot;productName&quot;</span><span style="color: rgb(204,120,50);">, </span><span style="color: rgb(106,135,89);">&quot;buildName&quot;</span><span style="color: rgb(204,120,50);">,<br/></span><span style="color: rgb(204,120,50);"> </span><span style="color: rgb(106,135,89);">&quot;versionName&quot;</span><span style="color: rgb(204,120,50);">, </span><span style="color: rgb(106,135,89);">&quot;userNote&quot;</span><span style="color: rgb(204,120,50);">, </span><span style="color: rgb(106,135,89);">&quot;hostName&quot;</span><span style="color: rgb(204,120,50);">, </span><span style="color: rgb(106,135,89);">&quot;timestamp&quot;</span>]<br/>START_SUITE_KEYS = [<span style="color: rgb(106,135,89);">&quot;suiteName&quot;</span><span style="color: rgb(204,120,50);">, </span><span style="color: rgb(106,135,89);">&quot;packageName&quot;</span><span style="color: rgb(204,120,50);">, </span><span style="color: rgb(106,135,89);">&quot;timestamp&quot;</span><span style="color: rgb(204,120,50);">, </span><span style="color: rgb(106,135,89);">&quot;parentId&quot;</span><span style="color: rgb(204,120,50);">, </span><span style="color: rgb(106,135,89);">&quot;parentType&quot;</span><span style="color: rgb(204,120,50);">, </span><span style="color: rgb(106,135,89);">&quot;sessionId&quot;</span>]<br/>START_TESTCASE_KEYS = [<span style="color: rgb(106,135,89);">&quot;sessionId&quot;</span><span style="color: rgb(204,120,50);">, </span><span style="color: rgb(106,135,89);">&quot;testcaseName&quot;</span><span style="color: rgb(204,120,50);">, </span><span style="color: rgb(106,135,89);">&quot;scenarioName&quot;</span><span style="color: rgb(204,120,50);">, </span><span style="color: rgb(106,135,89);">&quot;scenarioDescription&quot;</span><span style="color: rgb(204,120,50);">, </span><span style="color: rgb(106,135,89);">&quot;timestamp&quot;</span><span style="color: rgb(204,120,50);">, </span><span style="color: rgb(106,135,89);">&quot;parentId&quot;</span><span style="color: rgb(204,120,50);">,<br/></span><span style="color: rgb(204,120,50);"> </span><span style="color: rgb(106,135,89);">&quot;parentType&quot;</span>]<br/>INSERT_MESSAGE_KEYS = [<span style="color: rgb(106,135,89);">&quot;sessionId&quot;</span><span style="color: rgb(204,120,50);">, </span><span style="color: rgb(106,135,89);">&quot;machineName&quot;</span><span style="color: rgb(204,120,50);">, </span><span style="color: rgb(106,135,89);">&quot;threadName&quot;</span><span style="color: rgb(204,120,50);">, </span><span style="color: rgb(106,135,89);">&quot;level&quot;</span><span style="color: rgb(204,120,50);">, </span><span style="color: rgb(106,135,89);">&quot;message&quot;</span><span style="color: rgb(204,120,50);">, </span><span style="color: rgb(106,135,89);">&quot;timestamp&quot;</span><span style="color: rgb(204,120,50);">, </span><span style="color: rgb(106,135,89);">&quot;parentId&quot;</span><span style="color: rgb(204,120,50);">,<br/></span><span style="color: rgb(204,120,50);"> </span><span style="color: rgb(106,135,89);">&quot;parentType&quot;</span>]<br/>INSERT_MESSAGES_KEYS = [<span style="color: rgb(106,135,89);">&quot;sessionId&quot;</span><span style="color: rgb(204,120,50);">, </span><span style="color: rgb(106,135,89);">&quot;parentType&quot;</span><span style="color: rgb(204,120,50);">, </span><span style="color: rgb(106,135,89);">&quot;parentId&quot;</span><span style="color: rgb(204,120,50);">, </span><span style="color: rgb(106,135,89);">&quot;timestamp&quot;</span><span style="color: rgb(204,120,50);">, </span><span style="color: rgb(106,135,89);">&quot;messages&quot;</span>]<br/>ADD_RUN_METAINFO_KEYS = [<span style="color: rgb(106,135,89);">&quot;sessionId&quot;</span><span style="color: rgb(204,120,50);">, </span><span style="color: rgb(106,135,89);">&quot;metaKey&quot;</span><span style="color: rgb(204,120,50);">, </span><span style="color: rgb(106,135,89);">&quot;metaValue&quot;</span>]<br/>ADD_SCENARIO_METAINFO_KEYS = [<span style="color: rgb(106,135,89);">&quot;sessionId&quot;</span><span style="color: rgb(204,120,50);">, </span><span style="color: rgb(106,135,89);">&quot;parentId&quot;</span><span style="color: rgb(204,120,50);">, </span><span style="color: rgb(106,135,89);">&quot;metaKey&quot;</span><span style="color: rgb(204,120,50);">, </span><span style="color: rgb(106,135,89);">&quot;metaValue&quot;</span>]<br/>UPDATE_RUN_KEYS = [<span style="color: rgb(106,135,89);">&quot;sessionId&quot;</span><span style="color: rgb(204,120,50);">, </span><span style="color: rgb(106,135,89);">&quot;runName&quot;</span><span style="color: rgb(204,120,50);">, </span><span style="color: rgb(106,135,89);">&quot;osName&quot;</span><span style="color: rgb(204,120,50);">, </span><span style="color: rgb(106,135,89);">&quot;productName&quot;</span><span style="color: rgb(204,120,50);">, </span><span style="color: rgb(106,135,89);">&quot;buildName&quot;</span><span style="color: rgb(204,120,50);">, </span><span style="color: rgb(106,135,89);">&quot;versionName&quot;</span><span style="color: rgb(204,120,50);">, </span><span style="color: rgb(106,135,89);">&quot;userNote&quot;</span><span style="color: rgb(204,120,50);">, </span><span style="color: rgb(106,135,89);">&quot;hostName&quot;</span>]<br/>UPDATE_SUITE_KEYS = [<span style="color: rgb(106,135,89);">&quot;sessionId&quot;</span><span style="color: rgb(204,120,50);">, </span><span style="color: rgb(106,135,89);">&quot;suiteId&quot;</span><span style="color: rgb(204,120,50);">, </span><span style="color: rgb(106,135,89);">&quot;suiteName&quot;</span><span style="color: rgb(204,120,50);">, </span><span style="color: rgb(106,135,89);">&quot;userNote&quot;</span>]<br/>END_TESTCASE_KEYS = [<span style="color: rgb(106,135,89);">&quot;sessionId&quot;</span><span style="color: rgb(204,120,50);">, </span><span style="color: rgb(106,135,89);">&quot;result&quot;</span><span style="color: rgb(204,120,50);">, </span><span style="color: rgb(106,135,89);">&quot;timestamp&quot;</span><span style="color: rgb(204,120,50);">, </span><span style="color: rgb(106,135,89);">&quot;testcaseId&quot;</span>]<br/>END_SUITE_KEYS = [<span style="color: rgb(106,135,89);">&quot;suiteId&quot;</span><span style="color: rgb(204,120,50);">, </span><span style="color: rgb(106,135,89);">&quot;sessionId&quot;</span><span style="color: rgb(204,120,50);">, </span><span style="color: rgb(106,135,89);">&quot;timestamp&quot;</span>]<br/>END_RUN_KEYS = [<span style="color: rgb(106,135,89);">&quot;sessionId&quot;</span><span style="color: rgb(204,120,50);">, </span><span style="color: rgb(106,135,89);">&quot;timestamp&quot;</span>]<br/><br/><span style="color: rgb(128,128,128);"># enable logging of message on each HTTP method execution<br/></span>DEBUG = <span style="color: rgb(204,120,50);">False<br/></span><span style="color: rgb(204,120,50);"><br/></span><span style="color: rgb(204,120,50);"><br/></span><span style="color: rgb(128,128,128);"># this function will additionally process the json value<br/></span><span style="color: rgb(204,120,50);">def </span><span style="color: rgb(255,198,109);">check_json_value</span>(value):<br/>    <span style="color: rgb(204,120,50);">if </span>value <span style="color: rgb(204,120,50);">is None</span>:<br/>        <span style="color: rgb(204,120,50);">return </span><span style="color: rgb(106,135,89);">&quot;null&quot;<br/></span><span style="color: rgb(106,135,89);"> </span><span style="color: rgb(204,120,50);">elif </span><span style="color: rgb(136,136,198);">type</span>(value) <span style="color: rgb(204,120,50);">is </span><span style="color: rgb(136,136,198);">list</span>:<br/>        <span style="color: rgb(204,120,50);">return </span>json.dumps(value)<br/>    <span style="color: rgb(204,120,50);">else</span>:<br/>        <span style="color: rgb(204,120,50);">return </span><span style="color: rgb(106,135,89);">&quot;</span><span style="color: rgb(204,120,50);">\&quot;</span><span style="color: rgb(106,135,89);">&quot; </span>+ value + <span style="color: rgb(106,135,89);">&quot;</span><span style="color: rgb(204,120,50);">\&quot;</span><span style="color: rgb(106,135,89);">&quot;<br/></span><span style="color: rgb(106,135,89);"><br/></span><span style="color: rgb(106,135,89);"><br/></span><span style="color: rgb(128,128,128);"># this can be replaced with the built-in JSON functionality<br/></span><span style="color: rgb(204,120,50);">def </span><span style="color: rgb(255,198,109);">create_json</span>(keys<span style="color: rgb(204,120,50);">, </span>values):<br/>    json_data = <span style="color: rgb(106,135,89);">&quot;{&quot;<br/></span><span style="color: rgb(106,135,89);"> </span><span style="color: rgb(204,120,50);">for </span>idx <span style="color: rgb(204,120,50);">in </span><span style="color: rgb(136,136,198);">range</span>(<span style="color: rgb(136,136,198);">len</span>(keys)):<br/>        json_data += <span style="color: rgb(106,135,89);">&quot;</span><span style="color: rgb(204,120,50);">\&quot;</span><span style="color: rgb(106,135,89);">&quot; </span>+ keys[idx] + <span style="color: rgb(106,135,89);">&quot;</span><span style="color: rgb(204,120,50);">\&quot;</span><span style="color: rgb(106,135,89);">:&quot; </span>+ check_json_value(values[idx]) + <span style="color: rgb(106,135,89);">&quot;,&quot;<br/></span><span style="color: rgb(106,135,89);"> </span>json_data = json_data[<span style="color: rgb(104,151,187);">0</span>:<span style="color: rgb(136,136,198);">len</span>(json_data) - <span style="color: rgb(104,151,187);">1</span>]  <span style="color: rgb(128,128,128);"># remove trailing comma<br/></span><span style="color: rgb(128,128,128);"> </span>json_data += <span style="color: rgb(106,135,89);">&quot;}&quot;<br/></span><span style="color: rgb(106,135,89);"> </span><span style="color: rgb(204,120,50);">return </span>json_data<br/><br/><br/><span style="color: rgb(204,120,50);">def </span><span style="color: rgb(255,198,109);">do_http_method</span>(method_name<span style="color: rgb(204,120,50);">, </span>base_url<span style="color: rgb(204,120,50);">, </span>rel_url<span style="color: rgb(204,120,50);">, </span>headers={}<span style="color: rgb(204,120,50);">, </span>body=<span style="color: rgb(204,120,50);">None</span>):<br/>    <span style="color: rgb(204,120,50);">if </span>DEBUG:<br/>        <span style="color: rgb(136,136,198);">print</span>(<span style="color: rgb(106,135,89);">&quot;Executing '{}' HTTP method to URL '{}' with headers '{}' and body '{}'&quot;</span>.format(method_name<span style="color: rgb(204,120,50);">,<br/></span><span style="color: rgb(204,120,50);"> </span>base_url + rel_url<span style="color: rgb(204,120,50);">,<br/></span><span style="color: rgb(204,120,50);"> </span>headers<span style="color: rgb(204,120,50);">, </span>body))<br/>    conn = http.client.HTTPConnection(base_url)<br/>    conn.request(method_name<span style="color: rgb(204,120,50);">, </span>rel_url<span style="color: rgb(204,120,50);">, </span>body<span style="color: rgb(204,120,50);">, </span>headers)<br/>    resp = conn.getresponse()<br/>    conn.close()<br/>    <span style="color: rgb(204,120,50);">return </span>resp<br/><br/><br/><span style="color: rgb(204,120,50);">def </span><span style="color: rgb(255,198,109);">http_post</span>(base_url<span style="color: rgb(204,120,50);">, </span>rel_url<span style="color: rgb(204,120,50);">, </span>headers<span style="color: rgb(204,120,50);">, </span>body):<br/>    <span style="color: rgb(204,120,50);">return </span>do_http_method(<span style="color: rgb(106,135,89);">&quot;POST&quot;</span><span style="color: rgb(204,120,50);">, </span>base_url<span style="color: rgb(204,120,50);">, </span>rel_url<span style="color: rgb(204,120,50);">, </span>headers<span style="color: rgb(204,120,50);">, </span>body)<br/><br/><br/><span style="color: rgb(204,120,50);">def </span><span style="color: rgb(255,198,109);">http_get</span>(base_url<span style="color: rgb(204,120,50);">, </span>rel_url<span style="color: rgb(204,120,50);">, </span>headers):<br/>    <span style="color: rgb(204,120,50);">return </span>do_http_method(<span style="color: rgb(106,135,89);">&quot;GET&quot;</span><span style="color: rgb(204,120,50);">, </span>base_url<span style="color: rgb(204,120,50);">, </span>rel_url<span style="color: rgb(204,120,50);">, </span>headers)<br/><br/><br/><span style="color: rgb(204,120,50);">def </span><span style="color: rgb(255,198,109);">http_put</span>(base_url<span style="color: rgb(204,120,50);">, </span>rel_url<span style="color: rgb(204,120,50);">, </span>headers<span style="color: rgb(204,120,50);">, </span>body):<br/>    <span style="color: rgb(204,120,50);">return </span>do_http_method(<span style="color: rgb(106,135,89);">&quot;PUT&quot;</span><span style="color: rgb(204,120,50);">, </span>base_url<span style="color: rgb(204,120,50);">, </span>rel_url<span style="color: rgb(204,120,50);">, </span>headers<span style="color: rgb(204,120,50);">, </span>body)<br/><br/><br/><span style="color: rgb(204,120,50);">def </span><span style="color: rgb(255,198,109);">start_run</span>(db_host<span style="color: rgb(204,120,50);">, </span>db_name<span style="color: rgb(204,120,50);">, </span>db_user<span style="color: rgb(204,120,50);">, </span>db_password<span style="color: rgb(204,120,50);">, </span>run_name<span style="color: rgb(204,120,50);">, </span>os_name<span style="color: rgb(204,120,50);">, </span>product_name<span style="color: rgb(204,120,50);">, </span>build_name<span style="color: rgb(204,120,50);">, </span>version_name<span style="color: rgb(204,120,50);">,<br/></span><span style="color: rgb(204,120,50);"> </span>user_note<span style="color: rgb(204,120,50);">, </span>host_name<span style="color: rgb(204,120,50);">, </span>timestamp):<br/>    rel_url = HTTP_DB_LOGGER_LOGGER_URL + <span style="color: rgb(106,135,89);">&quot;/&quot; </span>+ START_RUN_REL_URL<br/>    headers = {<span style="color: rgb(106,135,89);">&quot;Content-type&quot;</span>: <span style="color: rgb(106,135,89);">&quot;application/json&quot;</span><span style="color: rgb(204,120,50);">, </span><span style="color: rgb(106,135,89);">&quot;Accept&quot;</span>: <span style="color: rgb(106,135,89);">&quot;application/json&quot;</span>}<br/>    body = create_json(START_RUN_KEYS<span style="color: rgb(204,120,50);">,<br/></span><span style="color: rgb(204,120,50);"> </span>[db_host<span style="color: rgb(204,120,50);">, </span>db_name<span style="color: rgb(204,120,50);">, </span>db_user<span style="color: rgb(204,120,50);">, </span>db_password<span style="color: rgb(204,120,50);">, </span>run_name<span style="color: rgb(204,120,50);">, </span>os_name<span style="color: rgb(204,120,50);">, </span>product_name<span style="color: rgb(204,120,50);">, </span>build_name<span style="color: rgb(204,120,50);">,<br/></span><span style="color: rgb(204,120,50);"> </span>version_name<span style="color: rgb(204,120,50);">, </span>user_note<span style="color: rgb(204,120,50);">, </span>host_name<span style="color: rgb(204,120,50);">, </span>timestamp])<br/>    <span style="color: rgb(204,120,50);">return </span>http_post(WEBSERVER_URL<span style="color: rgb(204,120,50);">, </span>rel_url<span style="color: rgb(204,120,50);">, </span>headers<span style="color: rgb(204,120,50);">, </span>body)<br/><br/><br/><span style="color: rgb(204,120,50);">def </span><span style="color: rgb(255,198,109);">start_suite</span>(suite_name<span style="color: rgb(204,120,50);">, </span>package_name<span style="color: rgb(204,120,50);">, </span>timestamp<span style="color: rgb(204,120,50);">, </span>parent_id<span style="color: rgb(204,120,50);">, </span>parent_type<span style="color: rgb(204,120,50);">, </span>session_id):<br/>    rel_url = HTTP_DB_LOGGER_LOGGER_URL + <span style="color: rgb(106,135,89);">&quot;/&quot; </span>+ START_SUITE_REL_URL<br/>    headers = {<span style="color: rgb(106,135,89);">&quot;Content-type&quot;</span>: <span style="color: rgb(106,135,89);">&quot;application/json&quot;</span><span style="color: rgb(204,120,50);">, </span><span style="color: rgb(106,135,89);">&quot;Accept&quot;</span>: <span style="color: rgb(106,135,89);">&quot;application/json&quot;</span>}<br/>    body = create_json(START_SUITE_KEYS<span style="color: rgb(204,120,50);">, </span>[suite_name<span style="color: rgb(204,120,50);">, </span>package_name<span style="color: rgb(204,120,50);">, </span>timestamp<span style="color: rgb(204,120,50);">, </span>parent_id<span style="color: rgb(204,120,50);">, </span>parent_type<span style="color: rgb(204,120,50);">, </span>session_id])<br/>    <span style="color: rgb(204,120,50);">return </span>http_post(WEBSERVER_URL<span style="color: rgb(204,120,50);">, </span>rel_url<span style="color: rgb(204,120,50);">, </span>headers<span style="color: rgb(204,120,50);">, </span>body)<br/><br/><br/><span style="color: rgb(204,120,50);">def </span><span style="color: rgb(255,198,109);">start_testcase</span>(session_id<span style="color: rgb(204,120,50);">, </span>testcase_name<span style="color: rgb(204,120,50);">, </span>scenario_name<span style="color: rgb(204,120,50);">, </span>description<span style="color: rgb(204,120,50);">, </span>timestamp<span style="color: rgb(204,120,50);">, </span>parent_id<span style="color: rgb(204,120,50);">, </span>parent_type):<br/>    rel_url = HTTP_DB_LOGGER_LOGGER_URL + <span style="color: rgb(106,135,89);">&quot;/&quot; </span>+ START_TESTCASE_REL_URL<br/>    headers = {<span style="color: rgb(106,135,89);">&quot;Content-type&quot;</span>: <span style="color: rgb(106,135,89);">&quot;application/json&quot;</span><span style="color: rgb(204,120,50);">, </span><span style="color: rgb(106,135,89);">&quot;Accept&quot;</span>: <span style="color: rgb(106,135,89);">&quot;application/json&quot;</span>}<br/>    body = create_json(START_TESTCASE_KEYS<span style="color: rgb(204,120,50);">,<br/></span><span style="color: rgb(204,120,50);"> </span>[session_id<span style="color: rgb(204,120,50);">, </span>testcase_name<span style="color: rgb(204,120,50);">, </span>scenario_name<span style="color: rgb(204,120,50);">, </span>description<span style="color: rgb(204,120,50);">, </span>timestamp<span style="color: rgb(204,120,50);">, </span>parent_id<span style="color: rgb(204,120,50);">, </span>parent_type])<br/>    <span style="color: rgb(204,120,50);">return </span>http_post(WEBSERVER_URL<span style="color: rgb(204,120,50);">, </span>rel_url<span style="color: rgb(204,120,50);">, </span>headers<span style="color: rgb(204,120,50);">, </span>body)<br/><br/><br/><span style="color: rgb(204,120,50);">def </span><span style="color: rgb(255,198,109);">end_testcase</span>(session_id<span style="color: rgb(204,120,50);">, </span>result<span style="color: rgb(204,120,50);">, </span>timestamp<span style="color: rgb(204,120,50);">, </span>testcase_id):<br/>    rel_url = HTTP_DB_LOGGER_LOGGER_URL + <span style="color: rgb(106,135,89);">&quot;/&quot; </span>+ END_TESTCASE_REL_URL<br/>    headers = {<span style="color: rgb(106,135,89);">&quot;Content-type&quot;</span>: <span style="color: rgb(106,135,89);">&quot;application/json&quot;</span><span style="color: rgb(204,120,50);">, </span><span style="color: rgb(106,135,89);">&quot;Accept&quot;</span>: <span style="color: rgb(106,135,89);">&quot;application/json&quot;</span>}<br/>    body = create_json(END_TESTCASE_KEYS<span style="color: rgb(204,120,50);">, </span>[session_id<span style="color: rgb(204,120,50);">, </span>result<span style="color: rgb(204,120,50);">, </span>timestamp<span style="color: rgb(204,120,50);">, </span>testcase_id])<br/>    <span style="color: rgb(204,120,50);">return </span>http_post(WEBSERVER_URL<span style="color: rgb(204,120,50);">, </span>rel_url<span style="color: rgb(204,120,50);">, </span>headers<span style="color: rgb(204,120,50);">, </span>body)<br/><br/><br/><span style="color: rgb(204,120,50);">def </span><span style="color: rgb(255,198,109);">end_suite</span>(suite_id<span style="color: rgb(204,120,50);">, </span>session_id<span style="color: rgb(204,120,50);">, </span>timestamp):<br/>    rel_url = HTTP_DB_LOGGER_LOGGER_URL + <span style="color: rgb(106,135,89);">&quot;/&quot; </span>+ END_SUITE_REL_URL<br/>    headers = {<span style="color: rgb(106,135,89);">&quot;Content-type&quot;</span>: <span style="color: rgb(106,135,89);">&quot;application/json&quot;</span><span style="color: rgb(204,120,50);">, </span><span style="color: rgb(106,135,89);">&quot;Accept&quot;</span>: <span style="color: rgb(106,135,89);">&quot;application/json&quot;</span>}<br/>    body = create_json(END_SUITE_KEYS<span style="color: rgb(204,120,50);">, </span>[suite_id<span style="color: rgb(204,120,50);">, </span>session_id<span style="color: rgb(204,120,50);">, </span>timestamp])<br/>    <span style="color: rgb(204,120,50);">return </span>http_post(WEBSERVER_URL<span style="color: rgb(204,120,50);">, </span>rel_url<span style="color: rgb(204,120,50);">, </span>headers<span style="color: rgb(204,120,50);">, </span>body)<br/><br/><br/><span style="color: rgb(204,120,50);">def </span><span style="color: rgb(255,198,109);">end_run</span>(session_id<span style="color: rgb(204,120,50);">, </span>timestamp):<br/>    rel_url = HTTP_DB_LOGGER_LOGGER_URL + <span style="color: rgb(106,135,89);">&quot;/&quot; </span>+ END_RUN_REL_URL<br/>    headers = {<span style="color: rgb(106,135,89);">&quot;Content-type&quot;</span>: <span style="color: rgb(106,135,89);">&quot;application/json&quot;</span><span style="color: rgb(204,120,50);">, </span><span style="color: rgb(106,135,89);">&quot;Accept&quot;</span>: <span style="color: rgb(106,135,89);">&quot;application/json&quot;</span>}<br/>    body = create_json(END_RUN_KEYS<span style="color: rgb(204,120,50);">, </span>[session_id<span style="color: rgb(204,120,50);">, </span>timestamp])<br/>    <span style="color: rgb(204,120,50);">return </span>http_post(WEBSERVER_URL<span style="color: rgb(204,120,50);">, </span>rel_url<span style="color: rgb(204,120,50);">, </span>headers<span style="color: rgb(204,120,50);">, </span>body)<br/><br/><br/><span style="color: rgb(204,120,50);">def </span><span style="color: rgb(255,198,109);">insert_message</span>(session_id<span style="color: rgb(204,120,50);">, </span>machine_name<span style="color: rgb(204,120,50);">, </span>thread_name<span style="color: rgb(204,120,50);">, </span>level<span style="color: rgb(204,120,50);">, </span>message<span style="color: rgb(204,120,50);">, </span>timestamp<span style="color: rgb(204,120,50);">, </span>parent_id<span style="color: rgb(204,120,50);">, </span>parent_type):<br/>    rel_url = HTTP_DB_LOGGER_LOGGER_URL + <span style="color: rgb(106,135,89);">&quot;/&quot; </span>+ INSERT_MESSAGE_REL_URL<br/>    headers = {<span style="color: rgb(106,135,89);">&quot;Content-type&quot;</span>: <span style="color: rgb(106,135,89);">&quot;application/json&quot;</span><span style="color: rgb(204,120,50);">, </span><span style="color: rgb(106,135,89);">&quot;Accept&quot;</span>: <span style="color: rgb(106,135,89);">&quot;application/json&quot;</span>}<br/>    body = create_json(INSERT_MESSAGE_KEYS<span style="color: rgb(204,120,50);">,<br/></span><span style="color: rgb(204,120,50);"> </span>[session_id<span style="color: rgb(204,120,50);">, </span>machine_name<span style="color: rgb(204,120,50);">, </span>thread_name<span style="color: rgb(204,120,50);">, </span>level<span style="color: rgb(204,120,50);">, </span>message<span style="color: rgb(204,120,50);">, </span>timestamp<span style="color: rgb(204,120,50);">, </span>parent_id<span style="color: rgb(204,120,50);">, </span>parent_type])<br/>    <span style="color: rgb(204,120,50);">return </span>http_post(WEBSERVER_URL<span style="color: rgb(204,120,50);">, </span>rel_url<span style="color: rgb(204,120,50);">, </span>headers<span style="color: rgb(204,120,50);">, </span>body)<br/><br/><br/><span style="color: rgb(204,120,50);">def </span><span style="color: rgb(255,198,109);">insert_messages</span>(session_id<span style="color: rgb(204,120,50);">, </span>parent_type<span style="color: rgb(204,120,50);">, </span>parent_id<span style="color: rgb(204,120,50);">, </span>timestamp<span style="color: rgb(204,120,50);">, </span>ins_messages):<br/>    rel_url = HTTP_DB_LOGGER_LOGGER_URL + <span style="color: rgb(106,135,89);">&quot;/&quot; </span>+ INSERT_MESSAGES_REL_URL<br/>    headers = {<span style="color: rgb(106,135,89);">&quot;Content-type&quot;</span>: <span style="color: rgb(106,135,89);">&quot;application/json&quot;</span><span style="color: rgb(204,120,50);">, </span><span style="color: rgb(106,135,89);">&quot;Accept&quot;</span>: <span style="color: rgb(106,135,89);">&quot;application/json&quot;</span>}<br/>    body = create_json(INSERT_MESSAGES_KEYS<span style="color: rgb(204,120,50);">, </span>[session_id<span style="color: rgb(204,120,50);">, </span>parent_type<span style="color: rgb(204,120,50);">, </span>parent_id<span style="color: rgb(204,120,50);">, </span>timestamp<span style="color: rgb(204,120,50);">, </span>ins_messages])<br/>    <span style="color: rgb(204,120,50);">return </span>http_post(WEBSERVER_URL<span style="color: rgb(204,120,50);">, </span>rel_url<span style="color: rgb(204,120,50);">, </span>headers<span style="color: rgb(204,120,50);">, </span>body)<br/><br/><br/><span style="color: rgb(204,120,50);">def </span><span style="color: rgb(255,198,109);">update_run</span>(session_id<span style="color: rgb(204,120,50);">, </span>run_name<span style="color: rgb(204,120,50);">, </span>os_name<span style="color: rgb(204,120,50);">, </span>product_name<span style="color: rgb(204,120,50);">, </span>build_name<span style="color: rgb(204,120,50);">, </span>version_name<span style="color: rgb(204,120,50);">, </span>user_note<span style="color: rgb(204,120,50);">, </span>host_name):<br/>    rel_url = HTTP_DB_LOGGER_LOGGER_URL + <span style="color: rgb(106,135,89);">&quot;/&quot; </span>+ UPDATE_RUN_REL_URL<br/>    headers = {<span style="color: rgb(106,135,89);">&quot;Content-type&quot;</span>: <span style="color: rgb(106,135,89);">&quot;application/json&quot;</span><span style="color: rgb(204,120,50);">, </span><span style="color: rgb(106,135,89);">&quot;Accept&quot;</span>: <span style="color: rgb(106,135,89);">&quot;application/json&quot;</span>}<br/>    body = create_json(UPDATE_RUN_KEYS<span style="color: rgb(204,120,50);">,<br/></span><span style="color: rgb(204,120,50);"> </span>[session_id<span style="color: rgb(204,120,50);">, </span>run_name<span style="color: rgb(204,120,50);">, </span>os_name<span style="color: rgb(204,120,50);">, </span>product_name<span style="color: rgb(204,120,50);">, </span>build_name<span style="color: rgb(204,120,50);">, </span>version_name<span style="color: rgb(204,120,50);">, </span>user_note<span style="color: rgb(204,120,50);">, </span>host_name])<br/>    <span style="color: rgb(204,120,50);">return </span>http_post(WEBSERVER_URL<span style="color: rgb(204,120,50);">, </span>rel_url<span style="color: rgb(204,120,50);">, </span>headers<span style="color: rgb(204,120,50);">, </span>body)<br/><br/><br/><span style="color: rgb(204,120,50);">def </span><span style="color: rgb(255,198,109);">update_suite</span>(session_id<span style="color: rgb(204,120,50);">, </span>suite_id<span style="color: rgb(204,120,50);">, </span>suite_name<span style="color: rgb(204,120,50);">, </span>user_note):<br/>    rel_url = HTTP_DB_LOGGER_LOGGER_URL + <span style="color: rgb(106,135,89);">&quot;/&quot; </span>+ UPDATE_SUITE_REL_URL<br/>    headers = {<span style="color: rgb(106,135,89);">&quot;Content-type&quot;</span>: <span style="color: rgb(106,135,89);">&quot;application/json&quot;</span><span style="color: rgb(204,120,50);">, </span><span style="color: rgb(106,135,89);">&quot;Accept&quot;</span>: <span style="color: rgb(106,135,89);">&quot;application/json&quot;</span>}<br/>    body = create_json(UPDATE_SUITE_KEYS<span style="color: rgb(204,120,50);">, </span>[session_id<span style="color: rgb(204,120,50);">, </span>suite_id<span style="color: rgb(204,120,50);">, </span>suite_name<span style="color: rgb(204,120,50);">, </span>user_note])<br/>    <span style="color: rgb(204,120,50);">return </span>http_post(WEBSERVER_URL<span style="color: rgb(204,120,50);">, </span>rel_url<span style="color: rgb(204,120,50);">, </span>headers<span style="color: rgb(204,120,50);">, </span>body)<br/><br/><br/><span style="color: rgb(204,120,50);">def </span><span style="color: rgb(255,198,109);">add_run_meta_info</span>(session_id<span style="color: rgb(204,120,50);">, </span>meta_key<span style="color: rgb(204,120,50);">, </span>meta_value):<br/>    rel_url = HTTP_DB_LOGGER_LOGGER_URL + <span style="color: rgb(106,135,89);">&quot;/&quot; </span>+ ADD_RUN_METAINFO_REL_URL<br/>    headers = {<span style="color: rgb(106,135,89);">&quot;Content-type&quot;</span>: <span style="color: rgb(106,135,89);">&quot;application/json&quot;</span><span style="color: rgb(204,120,50);">, </span><span style="color: rgb(106,135,89);">&quot;Accept&quot;</span>: <span style="color: rgb(106,135,89);">&quot;application/json&quot;</span>}<br/>    body = create_json(ADD_RUN_METAINFO_KEYS<span style="color: rgb(204,120,50);">, </span>[session_id<span style="color: rgb(204,120,50);">, </span>meta_key<span style="color: rgb(204,120,50);">, </span>meta_value])<br/>    <span style="color: rgb(204,120,50);">return </span>http_post(WEBSERVER_URL<span style="color: rgb(204,120,50);">, </span>rel_url<span style="color: rgb(204,120,50);">, </span>headers<span style="color: rgb(204,120,50);">, </span>body)<br/><br/><br/><span style="color: rgb(204,120,50);">def </span><span style="color: rgb(255,198,109);">add_scenario_meta_info</span>(session_id<span style="color: rgb(204,120,50);">, </span>testcase_id<span style="color: rgb(204,120,50);">, </span>meta_key<span style="color: rgb(204,120,50);">, </span>meta_value):<br/>    rel_url = HTTP_DB_LOGGER_LOGGER_URL + <span style="color: rgb(106,135,89);">&quot;/&quot; </span>+ ADD_SCENARIO_METAINFO_REL_URL<br/>    headers = {<span style="color: rgb(106,135,89);">&quot;Content-type&quot;</span>: <span style="color: rgb(106,135,89);">&quot;application/json&quot;</span><span style="color: rgb(204,120,50);">, </span><span style="color: rgb(106,135,89);">&quot;Accept&quot;</span>: <span style="color: rgb(106,135,89);">&quot;application/json&quot;</span>}<br/>    body = create_json(ADD_SCENARIO_METAINFO_KEYS<span style="color: rgb(204,120,50);">, </span>[session_id<span style="color: rgb(204,120,50);">, </span>testcase_id<span style="color: rgb(204,120,50);">, </span>meta_key<span style="color: rgb(204,120,50);">, </span>meta_value])<br/>    <span style="color: rgb(204,120,50);">return </span>http_post(WEBSERVER_URL<span style="color: rgb(204,120,50);">, </span>rel_url<span style="color: rgb(204,120,50);">, </span>headers<span style="color: rgb(204,120,50);">, </span>body)<br/><br/><br/><span style="color: rgb(204,120,50);">def </span><span style="color: rgb(255,198,109);">attach_file</span>(session_id<span style="color: rgb(204,120,50);">, </span>testcase_id<span style="color: rgb(204,120,50);">, </span>file_path<span style="color: rgb(204,120,50);">, </span>file_name):<br/>    rel_url = HTTP_DB_LOGGER_LOGGER_URL + <span style="color: rgb(106,135,89);">&quot;/&quot; </span>+ ATTACH_FILE<br/>    headers = {<span style="color: rgb(106,135,89);">&quot;Content-type&quot;</span>: <span style="color: rgb(106,135,89);">&quot;application/octet-stream&quot;</span><span style="color: rgb(204,120,50);">, </span><span style="color: rgb(106,135,89);">&quot;sessionId&quot;</span>: session_id<span style="color: rgb(204,120,50);">, </span><span style="color: rgb(106,135,89);">&quot;testcaseId&quot;</span>: testcase_id<span style="color: rgb(204,120,50);">,<br/></span><span style="color: rgb(204,120,50);"> </span><span style="color: rgb(106,135,89);">&quot;fileName&quot;</span>: file_name}<br/>    <span style="color: rgb(204,120,50);">return </span>http_put(WEBSERVER_URL<span style="color: rgb(204,120,50);">, </span>rel_url<span style="color: rgb(204,120,50);">, </span>headers<span style="color: rgb(204,120,50);">, </span><span style="color: rgb(136,136,198);">open</span>(file_path))<br/><br/><br/><span style="color: rgb(128,128,128);"># variables for storing responses' data<br/></span>sessionId = <span style="color: rgb(204,120,50);">None<br/></span>runIds = []<br/>suiteIds = []<br/>testcaseIds = []<br/><br/><span style="color: rgb(128,128,128);"># start a run<br/></span>response = start_run(<span style="color: rgb(106,135,89);">&quot;localhost&quot;</span><span style="color: rgb(204,120,50);">, </span><span style="color: rgb(106,135,89);">&quot;TestDb&quot;</span><span style="color: rgb(204,120,50);">, </span><span style="color: rgb(106,135,89);">&quot;AtsUser&quot;</span><span style="color: rgb(204,120,50);">, </span><span style="color: rgb(106,135,89);">&quot;AtsPassword&quot;</span><span style="color: rgb(204,120,50);">, </span><span style="color: rgb(106,135,89);">&quot;testRun1&quot;</span><span style="color: rgb(204,120,50);">, </span><span style="color: rgb(106,135,89);">&quot;LINUX&quot;</span><span style="color: rgb(204,120,50);">, </span><span style="color: rgb(106,135,89);">&quot;Ats HttpDbLogger&quot;</span><span style="color: rgb(204,120,50);">, </span><span style="color: rgb(106,135,89);">&quot;1&quot;</span><span style="color: rgb(204,120,50);">,<br/></span><span style="color: rgb(204,120,50);"> </span><span style="color: rgb(106,135,89);">&quot;4.0.2-SN&quot;</span><span style="color: rgb(204,120,50);">, </span><span style="color: rgb(106,135,89);">&quot;first run&quot;</span><span style="color: rgb(204,120,50);">, </span><span style="color: rgb(106,135,89);">&quot;ds-ws&quot;</span><span style="color: rgb(204,120,50);">, </span><span style="color: rgb(106,135,89);">&quot;-1&quot;</span>)<br/>sessiond = response.info()[<span style="color: rgb(106,135,89);">'sessionId'</span>]<br/>runId = response.info()[<span style="color: rgb(106,135,89);">'runId'</span>]<br/>runIds.append(runId)<br/><br/><span style="color: rgb(128,128,128);"># start a suite<br/></span>response = start_suite(<span style="color: rgb(106,135,89);">&quot;SuiteOne&quot;</span><span style="color: rgb(204,120,50);">, </span><span style="color: rgb(106,135,89);">&quot;com.example.ats&quot;</span><span style="color: rgb(204,120,50);">, </span><span style="color: rgb(106,135,89);">&quot;-1&quot;</span><span style="color: rgb(204,120,50);">, </span><span style="color: rgb(106,135,89);">&quot;-1&quot;</span><span style="color: rgb(204,120,50);">, </span><span style="color: rgb(106,135,89);">&quot;RUN&quot;</span><span style="color: rgb(204,120,50);">, </span>sessionId)<br/>suiteId = response.info()[<span style="color: rgb(106,135,89);">'suiteId'</span>]<br/>suiteIds.append(suiteId)<br/><br/><span style="color: rgb(128,128,128);"># start a testcase<br/></span>response = start_testcase(sessionId<span style="color: rgb(204,120,50);">, </span><span style="color: rgb(106,135,89);">&quot;TestCase1&quot;</span><span style="color: rgb(204,120,50);">, </span><span style="color: rgb(106,135,89);">&quot;Scenario1&quot;</span><span style="color: rgb(204,120,50);">, </span><span style="color: rgb(106,135,89);">&quot;The first scenario/testcase&quot;</span><span style="color: rgb(204,120,50);">, </span><span style="color: rgb(106,135,89);">&quot;-1&quot;</span><span style="color: rgb(204,120,50);">, </span><span style="color: rgb(106,135,89);">&quot;-1&quot;</span><span style="color: rgb(204,120,50);">, </span><span style="color: rgb(106,135,89);">&quot;SUITE&quot;</span>)<br/>testcaseId = response.info()[<span style="color: rgb(106,135,89);">'testcaseId'</span>]<br/>testcaseIds.append(testcaseId)<br/><br/><span style="color: rgb(128,128,128);"># insert single run and suite message<br/></span>insert_message(sessionId<span style="color: rgb(204,120,50);">, </span><span style="color: rgb(106,135,89);">&quot;ds-ws&quot;</span><span style="color: rgb(204,120,50);">, </span><span style="color: rgb(106,135,89);">&quot;main&quot;</span><span style="color: rgb(204,120,50);">, </span><span style="color: rgb(106,135,89);">&quot;INFO&quot;</span><span style="color: rgb(204,120,50);">, </span><span style="color: rgb(106,135,89);">&quot;Some run message with log level INFO&quot;</span><span style="color: rgb(204,120,50);">, </span><span style="color: rgb(106,135,89);">&quot;-1&quot;</span><span style="color: rgb(204,120,50);">, </span><span style="color: rgb(136,136,198);">str</span>(runId)<span style="color: rgb(204,120,50);">, </span><span style="color: rgb(106,135,89);">&quot;RUN&quot;</span>)<br/><span style="color: rgb(204,120,50);">for </span>suiteId <span style="color: rgb(204,120,50);">in </span>suiteIds:<br/>    insert_message(sessionId<span style="color: rgb(204,120,50);">, </span><span style="color: rgb(106,135,89);">&quot;ds-ws&quot;</span><span style="color: rgb(204,120,50);">, </span><span style="color: rgb(106,135,89);">&quot;main&quot;</span><span style="color: rgb(204,120,50);">, </span><span style="color: rgb(106,135,89);">&quot;INFO&quot;</span><span style="color: rgb(204,120,50);">, </span><span style="color: rgb(106,135,89);">&quot;Some suite message with log level INFO&quot;</span><span style="color: rgb(204,120,50);">, </span><span style="color: rgb(106,135,89);">&quot;-1&quot;</span><span style="color: rgb(204,120,50);">, </span><span style="color: rgb(136,136,198);">str</span>(suiteId)<span style="color: rgb(204,120,50);">,<br/></span><span style="color: rgb(204,120,50);"> </span><span style="color: rgb(106,135,89);">&quot;SUITE&quot;</span>)<br/><br/><span style="color: rgb(128,128,128);"># attach file to the current testcase<br/></span>attach_file(sessionId<span style="color: rgb(204,120,50);">, </span>testcaseId<span style="color: rgb(204,120,50);">, </span><span style="color: rgb(106,135,89);">&quot;D:</span><span style="color: rgb(204,120,50);">\\</span><span style="color: rgb(106,135,89);">test.txt&quot;</span><span style="color: rgb(204,120,50);">, </span><span style="color: rgb(106,135,89);">&quot;test.txt&quot;</span>)<br/><br/><span style="color: rgb(128,128,128);"># simulate some work by sleeping for 1 minute<br/></span><span style="color: rgb(128,128,128);"># os.system(&quot;sleep 60&quot;)<br/></span><span style="color: rgb(128,128,128);"><br/></span><span style="color: rgb(128,128,128);"># end all testcases<br/></span><span style="color: rgb(128,128,128);"># in order to do that, we have to disable/skip the default event state checking<br/></span><span style="color: rgb(128,128,128);"># and this is done by simply providing testcaseId, instead of -1<br/></span><span style="color: rgb(128,128,128);"># now instead of checking whether we can end a testcase<br/></span><span style="color: rgb(128,128,128);"># the HttpDbLogger will just check if the testcase, which we want to end is indeed already running and whether <br/></span><span style="color: rgb(128,128,128);"># it was started by the current session<br/></span><span style="color: rgb(204,120,50);">for </span>testcaseId <span style="color: rgb(204,120,50);">in </span>testcaseIds:<br/>    end_testcase(sessionId<span style="color: rgb(204,120,50);">, </span><span style="color: rgb(106,135,89);">&quot;PASSED&quot;</span><span style="color: rgb(204,120,50);">, </span><span style="color: rgb(106,135,89);">&quot;-1&quot;</span><span style="color: rgb(204,120,50);">, </span><span style="color: rgb(136,136,198);">str</span>(testcaseId))  <span style="color: rgb(128,128,128);"># here we are providing the testcaseId<br/></span><span style="color: rgb(128,128,128);"><br/></span><span style="color: rgb(128,128,128);"># insert more than one message for the first testcase<br/></span><span style="color: rgb(128,128,128);"># as you can see, by providing parentType and parentId,<br/></span><span style="color: rgb(128,128,128);"># we can insert messages in already ended/closed testcases<br/></span><span style="color: rgb(128,128,128);"># we also provide custom time stamp, which is the current time of the test executor <br/></span><span style="color: rgb(128,128,128);"># (e.g. our machine where this script will be executed)<br/></span>message1 = {<br/>    <span style="color: rgb(106,135,89);">'machineName'</span>: <span style="color: rgb(106,135,89);">'ds-ws'</span><span style="color: rgb(204,120,50);">,<br/></span><span style="color: rgb(204,120,50);"> </span><span style="color: rgb(106,135,89);">'threadName'</span>: <span style="color: rgb(106,135,89);">'main'</span><span style="color: rgb(204,120,50);">,<br/></span><span style="color: rgb(204,120,50);"> </span><span style="color: rgb(106,135,89);">'level'</span>: <span style="color: rgb(106,135,89);">'ERROR'</span><span style="color: rgb(204,120,50);">,<br/></span><span style="color: rgb(204,120,50);"> </span><span style="color: rgb(106,135,89);">'message'</span>: <span style="color: rgb(106,135,89);">'1/2 testcase messages logged at once'</span><span style="color: rgb(204,120,50);">,<br/></span><span style="color: rgb(204,120,50);"> </span><span style="color: rgb(106,135,89);">'timestamp'</span>: <span style="color: rgb(106,135,89);">'-1'</span><span style="color: rgb(204,120,50);">,<br/></span><span style="color: rgb(204,120,50);"> </span><span style="color: rgb(106,135,89);">'parentId'</span>: <span style="color: rgb(136,136,198);">str</span>(testcaseIds[<span style="color: rgb(104,151,187);">0</span>])<span style="color: rgb(204,120,50);">,<br/></span><span style="color: rgb(204,120,50);"> </span><span style="color: rgb(106,135,89);">'parentType'</span>: <span style="color: rgb(106,135,89);">'TESTCASE'<br/></span>}<br/>message2 = {<br/>    <span style="color: rgb(106,135,89);">'machineName'</span>: <span style="color: rgb(106,135,89);">'ds-ws'</span><span style="color: rgb(204,120,50);">,<br/></span><span style="color: rgb(204,120,50);"> </span><span style="color: rgb(106,135,89);">'threadName'</span>: <span style="color: rgb(106,135,89);">'main'</span><span style="color: rgb(204,120,50);">,<br/></span><span style="color: rgb(204,120,50);"> </span><span style="color: rgb(106,135,89);">'level'</span>: <span style="color: rgb(106,135,89);">'ERROR'</span><span style="color: rgb(204,120,50);">,<br/></span><span style="color: rgb(204,120,50);"> </span><span style="color: rgb(106,135,89);">'message'</span>: <span style="color: rgb(106,135,89);">'some error testcase message'</span><span style="color: rgb(204,120,50);">,<br/></span><span style="color: rgb(204,120,50);"> </span><span style="color: rgb(106,135,89);">'timestamp'</span>: <span style="color: rgb(106,135,89);">'2/2 testcase messages logged at once'</span><span style="color: rgb(204,120,50);">,<br/></span><span style="color: rgb(204,120,50);"> </span><span style="color: rgb(106,135,89);">'parentId'</span>: <span style="color: rgb(136,136,198);">str</span>(testcaseIds[<span style="color: rgb(104,151,187);">0</span>])<span style="color: rgb(204,120,50);">,<br/></span><span style="color: rgb(204,120,50);"> </span><span style="color: rgb(106,135,89);">'parentType'</span>: <span style="color: rgb(106,135,89);">'TESTCASE'<br/></span>}<br/>messages = [<br/>    message1<span style="color: rgb(204,120,50);">,<br/></span><span style="color: rgb(204,120,50);"> </span>message2<br/>]  <span style="color: rgb(128,128,128);"># </span><span style="color: rgb(168,192,35);">TODO dump messages list to a valid JSON string<br/></span><span style="color: rgb(204,120,50);">for </span>testcaseId <span style="color: rgb(204,120,50);">in </span>testcaseIds:<br/>    insert_messages(sessionId<span style="color: rgb(204,120,50);">, </span><span style="color: rgb(106,135,89);">&quot;TESTCASE&quot;</span><span style="color: rgb(204,120,50);">, </span><span style="color: rgb(136,136,198);">str</span>(testcaseId)<span style="color: rgb(204,120,50);">, </span><span style="color: rgb(106,135,89);">&quot;-1&quot;</span><span style="color: rgb(204,120,50);">, </span>messages)<br/><br/><span style="color: rgb(128,128,128);"># end all suites<br/></span><span style="color: rgb(128,128,128);"># again as with the ending of all the testcases,<br/></span><span style="color: rgb(128,128,128);"># we are providing suiteId, so the HttpDbLogger will skip any event logging state checking, <br/></span><span style="color: rgb(128,128,128);"># check if the requested suite (refered by the suiteId) is started by the current session<br/></span><span style="color: rgb(128,128,128);"># and if everything is OK, it will stop the suite<br/></span><span style="color: rgb(128,128,128);"># if an error occured, it's cause and Java stacktrace will be returned with the response's body<br/></span><span style="color: rgb(204,120,50);">for </span>i <span style="color: rgb(204,120,50);">in </span>suiteIds:<br/>    end_suite(<span style="color: rgb(136,136,198);">str</span>(i)<span style="color: rgb(204,120,50);">, </span>sessionId<span style="color: rgb(204,120,50);">, </span><span style="color: rgb(106,135,89);">&quot;-1&quot;</span>)<br/><br/><span style="color: rgb(128,128,128);"># end the run<br/></span>end_run(sessionId<span style="color: rgb(204,120,50);">, </span><span style="color: rgb(106,135,89);">&quot;-1&quot;</span>)<br/><br/><span style="color: rgb(128,128,128);"># update the already ended run<br/></span>update_run(sessionId<span style="color: rgb(204,120,50);">, </span><span style="color: rgb(106,135,89);">&quot;New testRun1&quot;</span><span style="color: rgb(204,120,50);">, None, None, None, None, None, </span><span style="color: rgb(106,135,89);">&quot;my workstation at home&quot;</span>)<br/><br/><span style="color: rgb(128,128,128);"># update each suite, that was started by this session<br/></span><span style="color: rgb(204,120,50);">for </span>suiteId <span style="color: rgb(204,120,50);">in </span>suiteIds:<br/>    update_suite(sessionId<span style="color: rgb(204,120,50);">, </span><span style="color: rgb(136,136,198);">str</span>(suiteId)<span style="color: rgb(204,120,50);">, </span><span style="color: rgb(106,135,89);">&quot;Some new suite name for suite with ID &quot; </span>+ <span style="color: rgb(136,136,198);">str</span>(i)<span style="color: rgb(204,120,50);">, </span><span style="color: rgb(106,135,89);">&quot;Suite with ID &quot; </span>+ <span style="color: rgb(136,136,198);">str</span>(i))<br/><br/><span style="color: rgb(128,128,128);"># add run metainfo<br/></span><span style="color: rgb(128,128,128);"># currently the only available metaKey value is type<br/></span>add_run_meta_info(sessionId<span style="color: rgb(204,120,50);">, </span><span style="color: rgb(106,135,89);">&quot;type&quot;</span><span style="color: rgb(204,120,50);">, </span><span style="color: rgb(106,135,89);">&quot;progression&quot;</span>)<br/><br/><span style="color: rgb(128,128,128);"># add scenario metainfo for each testcase<br/></span><span style="color: rgb(204,120,50);">for </span>testcaseId <span style="color: rgb(204,120,50);">in </span>testcaseIds:<br/>    <span style="color: rgb(204,120,50);">if </span><span style="color: rgb(136,136,198);">int</span>(i) % <span style="color: rgb(104,151,187);">2 </span>== <span style="color: rgb(104,151,187);">0</span>:<br/>        add_scenario_meta_info(sessionId<span style="color: rgb(204,120,50);">, </span><span style="color: rgb(136,136,198);">str</span>(testcaseId)<span style="color: rgb(204,120,50);">, </span><span style="color: rgb(106,135,89);">&quot;group&quot;</span><span style="color: rgb(204,120,50);">, </span><span style="color: rgb(106,135,89);">&quot;even&quot;</span>)<br/>    <span style="color: rgb(204,120,50);">else</span>:<br/>        add_scenario_meta_info(sessionId<span style="color: rgb(204,120,50);">, </span><span style="color: rgb(136,136,198);">str</span>(testcaseId)<span style="color: rgb(204,120,50);">, </span><span style="color: rgb(106,135,89);">&quot;group&quot;</span><span style="color: rgb(204,120,50);">, </span><span style="color: rgb(106,135,89);">&quot;odd&quot;</span>)</pre><p><br/></p><hr/><p>Go to<a href="Using-the-HTTP-DB-Logger.html">parent page</a></p><hr/><p><br/></p>
                    </div>

                    
                 
                </div>             </div> 
            

